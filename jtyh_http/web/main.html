<noscript>
    <center><H2>对不起,您的浏览器不支持Javascript,请更改您的浏览器选项以启用Javascript <br>如果你不知道如何设置浏览器, <a
            href='help_javascript.htm'>请点这里.</a></H2></center>
</noscript>


<html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="pragma" content="no-cache"/>
<meta http-equiv="cache-control" content="no-cache, must-revalidate"/>
<!--交行logo-->
<link rel="Shortcut Icon" href="images/logo.jpg" type="image/x-icon">
<link href="css/style.css" rel="stylesheet" type="text/css"/>
<head>
    <title>
        交通银行
    </title>
</head>
<script language="javascript" src="include/checkflash.js"></script>
<script language="javascript" src="include/common.js?v=1"></script>
<script language="javascript">


    //判断是否为手机登陆
    // isIphone = navigator.userAgent.toLowerCase().indexOf('iphone') == -1 ? 0 : 1;
    // if (isIphone == 0) {
    //     isIphone = navigator.userAgent.toLowerCase().indexOf('ipod') == -1 ? 0 : 1;
    // } else {
    //     isIphone = navigator.userAgent.toLowerCase().indexOf('ipad') == -1 ? 1 : 0;
    // }
    // isAndroid = navigator.userAgent.toLowerCase().indexOf('android') == -1 ? 0 : 1;
    // isWindowsPhone = navigator.userAgent.toLowerCase().indexOf('windows phone') == -1 ? 0 : 1;
    // if (isIphone || isAndroid || isWindowsPhone) {
    //     if (navigator.cookieEnabled)
    //         location = 'main_m.html';
    // }

    // document.cookie="1243" + "=" + escape(value) + "; expires=" + date.toGMTString() + "; path=/;";
    // alert(unescape(document.cookie).substring());


    //     var _TIMER_UPLOADING = null;
    //     var _TIMER_PPT = null;
    //     var _TIMER_KEEPLIVE = null;
    //     // session过期
    //     var EXPTag = "session expired";
    //     var ppt_showing = false;
    //     var ppt_timervalue = 5000;
    //     var ppt_startppt = "开始幻灯片";
    //     var ppt_stopppt = "停止幻灯片";
    //     var viewmode = false;
    //     var row_filenum = 5;
    //     var now_dir = "/";
    //     var now_image = "";
    //     var file_num = 0;
    //     var dir_num = 0;
    //     var total_num = 0;
    //     var thumb_num = 0;
    //     var total_size = 0;
    var selectedRow = null;
    //     var lastObj = null;
    //     var start_time = 0;
    //     var uploading = false;
    //     var upload_file = "";
    //     var upload_filename = "";
    //     //图片组？？
    //     var imageGroup = new Array();
    //     var imgMap = null;
    //     var imgMap2 = null;
    //     var imglist = null;
    //     var imglist2 = null;
    //     var download_url = "";
    //     var videolist_show = false;
    //     var last_uploadsize = 0;
    //     var last_lefttime = -1;
    //     var auto_overwrite = false;
    //     var appletSavePath = "none";
    //     var bigfilesize = 0;
    //     var moreaction_show = false;
    //     var txt_filename = "";
    //     var last_field = -1;
    //     var reverse_sort = 0;
    //     var enable_online_edit = "1";
    //     var weblink_url = "";
    //     var isEdge = navigator.userAgent.toLowerCase().indexOf("edge") > -1 && !isIE;
    //     var isIE11 = navigator.userAgent.toLowerCase().indexOf("trident") > -1;
    //
    //
    //     var charArray = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
    //
    //     /**
    //      * 生成随机数赋值给"downloadpass"的value
    //      */
    //     function generateRandom() {
    //         var result = "";
    //         for (var i = 0; i < 8; i++) {
    //             var index = 0;
    //             //ceil() 方法可对一个数进行上舍入。（大于等于 x，并且与它最接近的整数。）
    //             index = Math.ceil(Math.random() * (charArray.length - 1));
    //             result += charArray[index];
    //         }
    //         $("downloadpass").value = result;
    //     }
    //
    //     /**
    //      * 清空imageGroup
    //      */
    //     function clear_imageGroup() {
    //         imageGroup = null;
    //         imageGroup = new Array();
    //     }
    //
    //     /**
    //      * 去指定的url
    //      * @param url
    //      * @param newTab
    //      */
    //     function gotoUrl(url, newTab) {
    //         var isBrowserIE = navigator.userAgent.indexOf('MSIE') == -1 ? 0 : 1;
    //         if (isBrowserIE) {
    //             try {
    //                 if (newTab) {
    //                     //createElement() 方法可创建元素节点。此方法可返回一个 Element 对象。
    //                     var referLink = document.createElement("a");
    //                     //例：<a href="http://www.baidu.com">百度</a><br/>
    //                     referLink.href = url;
    //                     //target:在何处打开目标 URL。仅在 href 属性存在时使用
    //                     //_blank:在新窗口打开文档
    //                     referLink.target = "_blank";
    //                     //Body 对象代表文档的主体 (HTML body) 。
    //                     //appendChild() 方法可向节点的子节点列表的末尾添加新的子节点。
    //                     document.body.appendChild(referLink);
    //
    //                     referLink.click();
    //                     //删除子节点referLink
    //                     document.body.removeChild(referLink);
    //                 } else {
    //                     var referLink = document.createElement("a");
    //                     referLink.href = url;
    //                     document.body.appendChild(referLink);
    //                     referLink.click();
    //                 }
    //             } catch (e) {
    //                 //当前地址
    //                 window.location = url;
    //             }
    //         } else {    //not BrowserIE 不是IE浏览器的话
    //             if (newTab) {
    //                 window.open(url, "_blank");
    //             } else {
    //                 window.location = url;
    //             }
    //         }
    //     }
    //
    //     /**
    //      *
    //      */
        function ajaxResponse() {
            //XMLHttpRequest的属性，初次创建时，这个属性的值从 0 开始，直到接收到完整的 HTTP 响应，这个值增加到 4。
            //4	Loaded	HTTP响应已经完全接收。
            if (xmlhttp.readyState == 4) {
                ajaxlock = false;
                //由服务器返回的 HTTP 状态代码，200：成功 404："Not Found" 错误。
                // 当 readyState 小于 3 的时候读取这一属性会导致一个异常。
                if (xmlhttp.status == 200) {
                    try {
                        switch (page) {
                            case 'chdir':
                                //
                                chdir();
                                break;
                            case 'mkdir':
                                mkdir();
                                break;
                            case 'rmdir':
                                rmdir();
                                break;
                            case 'rename':
                                rename();
                                break;
                            case 'paste':
                                paste();
                                break;
                            case 'dir':
                                showlist();
                                break;
                            case 'ed2kurl':
                                ed2kurl();
                                break;
                            case 'changepass':
                                changepass();
                                break;
                            case 'checkdownload':
                                checkdownload_Result();
                                break;
                            case 'zip':
                                zip();
                                break;
                            case 'unzip':
                                unzip();
                                break;
                            case 'rmdirfile':
                                rmdirfile();
                                break;
                            case 'mkfile':
                                mkfile();
                                break;
                            case 'weblink':
                                weblink();
                                break;
                            case 'weblink_update':
                                weblink_update_result();
                                break;
                            case 'uplink':
                                uplink();
                                break;
                            case 'uplink_update':
                                uplink_update_result();
                                break;
                            case 'bookmark':
                                bookmark_result();
                                break;
                        }
                    } catch (e) {
                        if (page != "dir")
                            alert("获取数据失败!");
                    } finally {
                        if (page != "dir") {
                            $("waitingdiv").style.display = "none";
                            $("waitingdiv2").style.display = "none";
                        }
                    }
                } else {
                    $("waitingdiv").style.display = "none";
                    $("waitingdiv2").style.display = "none";
                    if (page != "")
                        alert("获取数据失败!");

                }
            }
        }
    //
    //     function uploadError() {
    //         if (uploading == true)
    //             alert("上传文件时发生了异常错误, 可能是没有上传权限(或者该文件被限制)造成的.");
    //         uploadEnd();
    //     }
    //
    //     function uploadRefresh() {
    //         var ajaxObject = false;
    //         ajaxObject = isIE ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();
    //
    //         if (ajaxObject) {
    //             ajaxObject.open("GET", "uploadstat.html?r=" + Math.random());
    //             ajaxObject.onreadystatechange = function () {
    //                 if (ajaxObject.readyState == 4) {
    //                     if (ajaxObject.status == 200) {
    //                         if (uploading == true) {
    //                             var result = trim(ajaxObject.responseText);
    //                             if (result == "-1") {
    //                                 if ((upload_filename != "" && upload_filename == upload_file) || upload_filename == "") {
    //                                     if (last_lefttime < 0 || last_lefttime > 4) {
    //                                         setTimeout("uploadError()", 1000);
    //                                     } else {
    //                                         uploadEnd_ok();
    //                                         ajaxRequest("dir", "");
    //                                     }
    //                                 } else {
    //                                     uploadEnd_ok();
    //                                     ajaxRequest("dir", "");
    //                                 }
    //                             } else if (result == "-2") {
    //                                 alert("上传文件时发生了异常错误, 可能是没有上传权限(或者该文件被限制)造成的.");
    //                                 uploadEnd();
    //                             } else if (result == "-3") {
    //                                 alert("上传错误: 超过最大配额");
    //                                 uploadEnd();
    //                                 ajaxRequest("dir", 'r=' + Math.random());
    //                             } else if (result == "-4") {
    //                                 alert("上传错误: 超过最大上传限制");
    //                                 uploadEnd();
    //                                 ajaxRequest("dir", 'r=' + Math.random());
    //                             } else if (result == "0") {
    //                                 alert("会话已经过期,请重新登录!");
    //                                 uploadEnd();
    //                             } else if (result != "") {
    //                                 try {
    //                                     result = result.split("/");
    //                                     var d = new Date();
    //                                     var end_time = d.getTime();
    //                                     if (parseInt(result[0]) < last_uploadsize) {
    //                                         result[0] = last_uploadsize;
    //                                     } else {
    //                                         last_uploadsize = result[0];
    //                                     }
    //                                     var speed = fileSize(1000 * result[0] / (end_time - start_time));
    //                                     var leftsize = (result[1] - result[0]) > 0 ? (result[1] - result[0]) : 0;
    //                                     var lefttime = leftsize / (1000 * result[0] / (end_time - start_time));
    //                                     var scale = round((result[0] / result[1]) * 100, 2);
    //                                     upload_filename = result[2];
    //                                     last_lefttime = parseInt(lefttime);
    //
    //                                     if (upload_filename != "" && upload_filename != upload_file) {
    //                                         uploadError();
    //                                         return;
    //                                     }
    //
    //                                     upload_filename = htmlencode(upload_filename);
    //
    //                                     $("uploadingDiv").innerHTML = "文件名:<span title='" + upload_filename + "'>" + upload_filename.substr(0, 32) + (upload_filename.length > 32 ? "..." : "") + "</span><br>文件大小:" + fileSize(result[1]) + "<br>已经上传了:" + fileSize(result[0]) + "<br>平均上传速度:" + speed + "/s";
    //                                     $("uploadingDiv").innerHTML += "<br>还剩余:" + fileSize(leftsize) + ", 大约需要:" + formatTime(lefttime);
    //                                     $("uploadingDiv").innerHTML += "<br><div class='progress_border'><div class='progress_bar' style='background-position:" + (100 - scale) + "% 0px'>" + scale + "%</div></div>";
    //                                 } catch (e) {
    //                                 }
    //                             }
    //                         }
    //
    //                     }
    //                     delete ajaxObject;
    //                     ajaxObject = null;
    //                 }
    //             }
    //             ajaxObject.send("");
    //         }
    //     }
    //
    //     /**
    //      * 提示会话过期，转到logout.html页面。
    //      */
    //     function sess_expire() {
    //         alert("会话已经过期,请重新登录!");
    //         //window.location = "logout.html";
    //         gotoUrl("logout.html");
    //     }
    //
    //     /**
    //      * chdir
    //      */
    //     function chdir() {
    //         //通过 responseText 属性来取回由服务器返回的数据。
    //         var result = trim(xmlhttp.responseText);
    //         //EXPTag = "session expired" 会话过期
    //         if (result == EXPTag) {
    //             //转到logout.html
    //             sess_expire();
    //             return;
    //         }
    //         //
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function mkdir() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         alert(result);
    //         top.closewindow();
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function rmdir() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         alert(result);
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function rename() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         alert(result);
    //         top.closewindow();
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function paste() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         alert(result);
    //         $("pasteitem").style.display = "none";
    //         $("pasteitem2").style.display = "none";
    //         $("pasteitem3").style.display = "none";
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //



    /**
     *
     *
     */
        function showlist() {
                //清空obj：文件列表
                clear("listview_div");
                //清空obj：videolist？？？？？
                clear("videolist_div");
                //清空图片组
                clear_imageGroup();
                //显示等待数据更新时的背景（取消display）
                $("waitingdiv").style.display = "";

                //当前限额
                var nowquota = 0;
                var maxquota = 0;

                var readfile = 0;

                //置为未选中
                selectedRow = null;
                file_num = 0;
                //目录数
                dir_num = 0;
                total_num = 0;
                total_size = 0;
                hitcount = 0;

                try {
                    //responseText属性会存储从服务器返回的数据
                    var result = trim(xmlhttp.responseText);
                    //EXPTag = "session expired"
                    if (result == EXPTag) {
                        //会话过期
                        sess_expire();
                        return;
                    }
                    //属性返回 XML 文档对象，可使用 W3C DOM 节点树的方法和属性来检查和解析该对象。
                    var xmldoc = xmlhttp.responseXML;
                    //？？？？未找到rowdata？？？？
                    //包含所有文件的DOM
                    var row = xmldoc.getElementsByTagName("rowdata");
                    //包含文件数
                    var rownum = row.length;

                    try {
                        //取xmldoc中的nowdir
                        now_dir = decodeURIComponent(xmlFieldValue(xmldoc, "nowdir"));
                    } catch (e) {
                        now_dir = xmlFieldValue(xmldoc, "nowdir");
                    }

                    //当前限额
                    nowquota = xmlFieldValue(xmldoc, "nowquota");
                    maxquota = xmlFieldValue(xmldoc, "maxquota");

                    //
                    readfile = xmlFieldValue(xmldoc, "readfile");


                    //listhead：列名表（名称、大小、类型、修改时间）(只有一个tr）
                    //rows:集合返回表格中所有行（TableRow 对象）的一个数组
                    //cells集合返回表格中所有单元格的一个数组。
                    //headcell:列名表的所有单元格
                    var headcell = $("listhead").rows[0].cells;

                    //id为listtabl的表：用来显示文件具体信息（目前无内容）
                    var htmltext = "<table id='listtable' width='100%' border='0' cellpadding='0' cellspacing='0' style='table-layout:fixed;'><thead><tr height='0'><td width='" + headcell[0].width + "'></td><td width='" + headcell[1].width + "'></td><td width='" + headcell[2].width + "'></td><td width='" + headcell[3].width + "'></td><td></td></tr></thead><tbody id='maintable'>";

                    //遍历（所有文件）
                    for (var i = 0; i < rownum; i++) {
                        try {
                            //取第i个文件
                            var myrow = row[i];
                            f_img = "";
                            //myrow(当前文件)中perm属性的值。
                            f_perm = xmlFieldValue(myrow, "perm");
                            f_size = xmlFieldValue(myrow, "size");
                            f_group = xmlFieldValue(myrow, "group");
                            f_date = xmlFieldValue(myrow, "date");
                            f_name = decodeURIComponent(xmlFieldValue(myrow, "name"));
                            f_dir = xmlFieldValue(myrow, "dir");
                            f_md5 = "";

                            //如果readfile等于1，返回文件的md5属性值。
                            if (readfile == 1) {
                                f_md5 = xmlFieldValue(myrow, "md5");
                            }

                            //文件大小
                            filesize = f_size;

                            //文件总大小
                            total_size += parseInt(f_size);

                            //dir_num：统计文件和目录总数
                            if (f_dir == 1) {
                                f_dir = "文件夹";
                                if (isIE)
                                    f_img = "<img _src='icons/directory.gif'> ";
                                else
                                    f_img = "<img src='icons/directory.gif'> ";
                                dir_num++;
                            } else {
                                //文件扩展名
                                var file_ext = getExtention(f_name);
                                //文明名格式转化
                                var file_name = urlEncodeSpecial(f_name);
                                //？？？？？（如exe类型的文件）
                                f_dir = "&nbsp;" + file_ext + " 类型的文件";
                                //文件大小转化为可读性的数据
                                f_size = fileSize(f_size);

                                //extIcons文件类型库
                                //文件类型在库中，则显示对应图片，否则显示默认图片。
                                if (isIE) {
                                    if (extIcons[file_ext] == true)
                                        f_img = "<img _src='icons/" + file_ext + ".gif'> ";
                                    else
                                        f_img = "<img _src='icons/default.gif'> ";
                                } else {
                                    if (extIcons[file_ext] == true)
                                        f_img = "<img src='icons/" + file_ext + ".gif'> ";
                                    else
                                        f_img = "<img src='icons/default.gif'> ";
                                }

                                //所有图片类型执行
                                if (file_ext == "gif" || file_ext == "png" || file_ext == "jpg" || file_ext == "jpeg" || file_ext == "bmp")
                                    //加入到图片组
                                    imageGroup.push(file_name);

                                file_num++;
                            }


                            //为htmltext(文件表)添加内容
                            //oncontextmenu='do_list_click(this,-1,1);'
                            // onclick='do_list_click(this,-1);'
                            // ondblclick='do_list_dblclick(this,-1);'
                            // tabIndex='-1'>";

                            if (isIE)
                                htmltext += "<tr class='listtr01' oncontextmenu='do_list_click(this,-1,1);' onclick='do_list_click(this,-1);' ondblclick='do_list_dblclick(this,-1);' tabIndex='-1'>";
                            else
                                htmltext += "<tr class='listtr01' oncontextmenu='do_list_click(this,-1,1);' onclick='do_list_click(this,-1);' tabIndex='-1'>";

                            htmltext += "<td class='paddingtd' id='tr_" + i + "' md5='" + f_md5 + "' fsize='" + filesize + "' name=\"" + htmlencode(f_name) + "\"><input type='checkbox' id='cid_" + i + "' cid='" + i + "' flag='list'> " + f_img + htmlencode(f_name) + "</td>";
                            htmltext += "<td>" + f_size + "</td>";
                            htmltext += "<td>" + f_dir + "</td>";
                            htmltext += "<td>" + f_date + "</td>";
                            htmltext += "<td></td></tr>";

                            total_num++;
                            lastsortcol = -1;

                        } catch (e) {
                        }
                    }

                    htmltext += "</tbody></table>";
                    write("listview_div", htmltext);
                    $("listview_div").scrollTop = 0;
                } catch (e) {
                    $("waitingdiv").style.display = "none";
                    $("waitingdiv2").style.display = "none";
                    var result = trim(xmlhttp.responseText);
                    if (result == EXPTag) {
                        sess_expire();
                        return;
                    }
                }

            $("statbar").innerHTML = "当前目录: <span title='" + htmlencode(now_dir) + "'>" + htmlencode(now_dir.substr(0, 100)) + (now_dir.length > 100 ? "..." : "") + "</span>&nbsp;&nbsp;&nbsp; 共有" + file_num + "个文件," + dir_num + "个文件夹,总大小为:" + fileSize(total_size);

            $("favorites_add").style.display = "";
            $("favorites_del").style.display = "none";
            for (var i = 0; i < $("bookmark").options.length; i++) {
                if ($("bookmark").options[i].value == now_dir) {
                    $("favorites_add").style.display = "none";
                    $("favorites_del").style.display = "";
                }
            }

            if ($("bookmark").options.length > 0) {
                $("bookmark").options[0].selected = true;
            }

            if (maxquota != 0) {
                if (parseInt(nowquota) > parseInt(maxquota)) {
                    nowquota = maxquota;
                }
                var scale = round((nowquota / maxquota) * 100, 2);
                var strUsedQuota = "磁盘配额: " + fileSize(nowquota) + " / " + fileSize(maxquota);
                $("diskquota").innerHTML = "<div class='progress_border2'><div class='progress_bar2' style='background-position:" + (100 - scale) + "% 0px'>" + scale + "%</div></div><div style='font-size:9px;color: #444;' title='" + strUsedQuota + "'>" + strUsedQuota + "</div>";
            }

            if (total_num > 0) {
                if (last_field == 0) {
                    sortTable(null, 'listtable', 0, 'filename');

                    if (reverse_sort == 1)
                        sortTable(null, 'listtable', 0, 'filename');
                } else if (last_field == 1) {
                    sortTable(null, 'listtable', 1, 'size');

                    if (reverse_sort == 1)
                        sortTable(null, 'listtable', 1, 'size');
                } else if (last_field == 2) {
                    sortTable(null, 'listtable', 2);

                    if (reverse_sort == 1)
                        sortTable(null, 'listtable', 2);
                } else if (last_field == 3) {
                    sortTable(null, 'listtable', 3);

                    if (reverse_sort == 1)
                        sortTable(null, 'listtable', 3);
                } else {
                    sortTable(null, "listtable", 2);
                }
            }

            thumb_num = 0;
            if (viewmode == true) showthumb();


            imglist = $("listview_div").getElementsByTagName("img");
            imgMap = null;
            imgMap = new Object();
            for (var ii = 0; ii < imglist.length; ii++) {
                var src = imglist[ii].getAttribute('_src');
                if (src) {
                    if (imgMap[src]) {
                        imgMap[src].push(ii);
                    } else {
                        imgMap[src] = new Array();
                        imgMap[src].push(ii);
                    }
                }
            }
            for (var imgurl in imgMap) {
                var imgindex = imgMap[imgurl][0];
                imglist[imgindex].onload = function () {
                    setImageList();
                }
                imglist[imgindex].src = imgurl;
            }

            viewmode = getCookie("viewmode");
            change_viewmode(viewmode);
            $("waitingdiv").style.display = "none";
            $("waitingdiv2").style.display = "none";

            if (lastArrow != null)
                lastArrow.style.backgroundImage = "";
        }


    //     function setImageList() {
    //         var imgurl = event.srcElement.src;
    //         imgurl = "icons/" + imgurl.substr(imgurl.lastIndexOf("/") + 1).toLowerCase();
    //         if (imgMap[imgurl] && imgMap[imgurl].length >= 1) {
    //             for (var jj = 1; jj < imgMap[imgurl].length; jj++) {
    //                 var imgindex = imgMap[imgurl][jj];
    //                 imglist[imgindex].src = imgurl;
    //             }
    //         }
    //     }
    //
    //
    //     function showthumb() {
    //         if (isIE)
    //             RemoveRow("thumbtable");
    //         else
    //             clear("thumbtable");
    //
    //         if (total_num <= 0) {
    //             $("waitingdiv").style.display = "none";
    //             $("waitingdiv2").style.display = "none";
    //             return;
    //         }
    //
    //         var screen_width = getBrowerWidth() > 1024 ? getBrowerWidth() : 1024;
    //         row_filenum = parseInt(screen_width / 200);
    //         var cell_width = parseInt(100 / row_filenum) + "%";
    //         var row = $("listtable").tBodies[0].rows;
    //         var tr = null;
    //
    //         for (var i = 0; i < row.length; i++) {
    //             try {
    //                 f_img = "";
    //                 f_name = row[i].cells[0].getAttribute("name");
    //                 f_filename = htmldecode(f_name);
    //                 f_md5 = row[i].cells[0].getAttribute("md5");
    //                 f_size = row[i].cells[1].innerHTML;
    //                 f_isdir = row[i].cells[2].innerHTML;
    //                 f_date = row[i].cells[3].innerHTML;
    //                 f_ext = getExtention(f_filename);
    //
    //                 var ischecked = "";
    //                 if ($("cid_" + i).checked) ischecked = "checked";
    //
    //                 if (f_md5 != "" && (f_ext == "gif" || f_ext == "png" || f_ext == "jpg" || f_ext == "jpeg")) {
    //                     f_img = "<div class='rect'><table style='width:100%;height:100%;'><tr><td class='boxalign'><input type='checkbox' " + ischecked + " ccid='" + i + "' onclick='clickCheckbox(this);'></td><td id='" + f_md5 + "' class='picalign'><img src='thumbimg/" + f_md5 + ".jpg?r=1' onerror='makethumb_req(\"" + f_md5 + "\",\"" + htmlencode(f_filename) + "\");'></td></tr></table></div>";
    //                 } else {
    //                     if (isIE) {
    //                         if (f_isdir == "文件夹") {
    //                             f_icon = "<img _src='icons/directory_b.gif'>";
    //                         } else {
    //                             if (extIcons[f_ext] == true)
    //                                 f_icon = "<img _src='icons/" + f_ext + "_b.gif'>";
    //                             else
    //                                 f_icon = "<img _src='icons/default_b.gif'>";
    //                         }
    //                     } else {
    //                         if (f_isdir == "文件夹") {
    //                             f_icon = "<img src='icons/directory_b.gif'>";
    //                         } else {
    //                             if (extIcons[f_ext] == true)
    //                                 f_icon = "<img src='icons/" + f_ext + "_b.gif'>";
    //                             else
    //                                 f_icon = "<img src='icons/default_b.gif'>";
    //                         }
    //                     }
    //                     f_img = "<div class='rect'><table style='width:100%;height:100%;'><tr><td class='boxalign'><input type='checkbox' " + ischecked + " ccid='" + i + "' onclick='clickCheckbox(this);'></td><td class='iconalign'>" + f_icon + "</td></tr></table></div>";
    //                 }
    //
    //                 if (i % row_filenum == 0) {
    //                     tr = document.createElement("tr");
    //                     tr.setAttribute('vAlign', 'top');
    //                     $("thumbtable").appendChild(tr);
    //                 }
    //                 var tmpcell = document.createElement("td");
    //                 if (isIE) {
    //                     tmpcell.onclick = function () {
    //                         do_list_click(this, -2);
    //                     }
    //                     tmpcell.oncontextmenu = function () {
    //                         do_list_click(this, -2, 1);
    //                     }
    //                     tmpcell.ondblclick = function () {
    //                         do_list_dblclick(this, -2);
    //                     }
    //                 } else {
    //                     tmpcell.setAttribute('onclick', 'do_list_click(this,' + i + ');');
    //                     tmpcell.setAttribute('oncontextmenu', 'do_list_click(this,' + i + ',1);');
    //                 }
    //                 tmpcell.setAttribute('width', cell_width);
    //                 tmpcell.setAttribute('class', 'listtr03');
    //                 tmpcell.setAttribute('className', 'listtr03');
    //                 tmpcell.setAttribute('name', f_name);
    //                 tmpcell.setAttribute('tabIndex', -1);
    //                 tmpcell.setAttribute('fsize', row[i].cells[0].getAttribute("fsize"));
    //                 tmpcell.setAttribute('id', "td_" + i);
    //                 tmpcell.setAttribute('title', '名称:' + f_filename + '\r\n大小:' + f_size + '\r\n修改时间:' + f_date);
    //                 tmpcell.innerHTML = f_img + htmlencode(f_filename.substr(0, 20)) + (f_filename.length > 20 ? "..." : "");
    //                 tr.appendChild(tmpcell);
    //                 thumb_num++;
    //             } catch (e) {
    //             }
    //         }
    //
    //         if (row.length > 0 && row.length < row_filenum) {
    //             var space_num = row_filenum - row.length;
    //             for (j = 0; j < space_num; j++) {
    //                 var tmpcell = document.createElement("td");
    //                 tmpcell.setAttribute('width', '20%');
    //                 tmpcell.setAttribute('height', '100');
    //                 tr.appendChild(tmpcell);
    //             }
    //         }
    //         $("thumbview_div").scrollTop = 0;
    //
    //         imglist2 = $("thumbview_div").getElementsByTagName("img");
    //         imgMap2 = null;
    //         imgMap2 = new Object();
    //         for (var ii = 0; ii < imglist2.length; ii++) {
    //             var src = imglist2[ii].getAttribute('_src');
    //             if (src) {
    //                 if (imgMap2[src]) {
    //                     imgMap2[src].push(ii);
    //                 } else {
    //                     imgMap2[src] = new Array();
    //                     imgMap2[src].push(ii);
    //                 }
    //             }
    //         }
    //         for (var imgurl2 in imgMap2) {
    //             var imgindex = imgMap2[imgurl2][0];
    //             imglist2[imgindex].onload = function () {
    //                 setImageThumb();
    //             }
    //             imglist2[imgindex].src = imgurl2;
    //         }
    //
    //         thumbimage_req = 0;
    //         thumbimage_rsp = 0;
    //         $("waitingdiv").style.display = "none";
    //         $("waitingdiv2").style.display = "none";
    //
    //     }
    //
    //     function setImageThumb() {
    //         var imgurl2 = event.srcElement.src;
    //         imgurl2 = "icons/" + imgurl2.substr(imgurl2.lastIndexOf("/") + 1).toLowerCase();
    //         if (imgMap2[imgurl2] && imgMap2[imgurl2].length >= 1) {
    //             for (var jj = 1; jj < imgMap2[imgurl2].length; jj++) {
    //                 var imgindex2 = imgMap2[imgurl2][jj];
    //                 imglist2[imgindex2].src = imgurl2;
    //             }
    //         }
    //     }



        /**
         *
         * @obj
         * @cellindex
         * @rightmouse
         * @return
         */
        function do_list_click(obj, cellindex, rightmouse) {
            var evt;
            try {
                //获得被触发的事件。
                evt = getEvent();
                //srcElement：对于生成事件的 Window 对象、Document 对象或 Element 对象的引用。
                //            触发事件的对象。
                var element = evt.srcElement || evt.target;
                //如果被触发的是INPUT，则返回空。
                if (element.tagName == "INPUT") {
                    return;
                }
            } catch (e) {
            }

            //
            var row_index = 0;
            var selectMultipleFiles = false;
            var offset = 1;
            //if(isEdge) offset = 2;


            //????????确定row_index的值
            if (cellindex >= 0)
                row_index = cellindex;
            else if (cellindex == -2)
                row_index = row_filenum * obj.parentNode.rowIndex + obj.cellIndex;
            else
                row_index = obj.rowIndex - offset;

            //表示隐藏这个控件；"visible"：表示显示这个控件
            // $("menu_div").style.visibility = "hidden";
            // $("menu_div2").style.visibility = "hidden";


            if (rightmouse == 1) {
                var evt = getEvent();
                moreaction_show = false;
                //更多操作菜单
                $("action_div").style.visibility = "hidden";
                //非文件右键菜单
                $("menu_div2").style.visibility = "hidden";
                //文件右键菜单出现
                $("menu_div").style.visibility = "";
                $("menu_div").style.top = evt.clientY - 150;
                $("menu_div").style.left = evt.clientX;
            } else {
                //ctrl被按
                if (CtrlPressed(evt)) {
                    try {
                        if (viewmode == true) {
                            var checkboxObj = obj.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];
                            var id = checkboxObj.getAttribute("ccid");
                            checkboxObj.checked = !checkboxObj.checked;
                            $("cid_" + id).checked = checkboxObj.checked;
                        } else {
                            var checkboxObj = obj.childNodes[0].childNodes[0];
                            checkboxObj.checked = !checkboxObj.checked;
                        }
                        selectMultipleFiles = true;
                    } catch (e) {
                    }
                }
            }

            if (selectedRow != $("maintable").rows[row_index]) {
                if (cellindex == -1) {
                    if (lastObj != null)
                        lastObj.className = "listtr01";
                    selectedRow = $("maintable").rows[row_index];
                    obj.className = "listtr02";
                    lastObj = obj;
                } else {
                    if (lastObj != null)
                        lastObj.className = "listtr03";
                    selectedRow = $("maintable").rows[row_index];
                    obj.className = "listtr04";
                    lastObj = obj;
                }

                try {
                    if (selectedRow != null) {
                        var f_name = htmldecode(selectedRow.cells[0].getAttribute("name"));

                        if (selectedRow.cells[2].innerHTML == "文件夹") {
                            $("uplinkitem").style.display = "";
                        } else {
                            $("uplinkitem").style.display = "none";
                        }

                        var file_ext = getExtention(f_name);
                        if (selectedRow.cells[2].innerHTML == "文件夹" || file_ext != "zip")
                            $("unzipitem").style.display = "none";
                        else
                            $("unzipitem").style.display = "";
                    }
                } catch (e) {
                }
            } else {
                if (rightmouse == 1 || selectMultipleFiles == true)
                    return false;

                if (!isIE || isWindowsPhone || isARM) {
                    if (evt.button == 0 || evt.button == 1 || evt.button == 2)
                        openFileDirectory();
                    else
                        downloadFile_ext();
                }
            }

            return false;
        }


        /**
         *
         * @obj
         * @cellindex
         */
        function do_list_dblclick(obj, cellindex) {
            var evt;
            try {
                evt = getEvent();
                var element = evt.srcElement || evt.target;
                if (element.tagName == "INPUT") {
                    return;
                }
            } catch (e) {
            }

            var row_index = 0;

            var offset = 1;
            //if(isEdge) offset = 2;

            if (cellindex >= 0)
                row_index = cellindex;
            else if (cellindex == -2)
                row_index = row_filenum * obj.parentNode.rowIndex + obj.cellIndex;
            else
                row_index = obj.rowIndex - offset;

            selectedRow = $("maintable").rows[row_index];

            if (selectedRow.cells[2].innerHTML == "文件夹") {
                openDirectory();
            } else {
                if (evt.keyCode != 13)
                    downloadFile();
                else
                    downloadFile_ext();
            }
            return false;
        }

        function openFileDirectory() {
            if (selectedRow.cells[2].innerHTML == "文件夹") {
                openDirectory();
            } else {
                downloadFile();
            }
        }


    //打开目录
    function openDirectory() {
        if (selectedRow == null) {
            alert("请选择一个文件夹");
            return;
        }
        //getAttribute()方法返回指定属性名的属性值。
        var f_name = selectedRow.cells[0].getAttribute("name");
        //代码转换
        var filename = urlEncode(htmldecode(f_name));
        //
        ajaxRequest("chdir", "dir=" + filename);
    }


        /**
         * 回到根目录
         */
        function goUp() {
            ajaxRequest("chdir", "dir=..");
        }
    //
    //     function goTo() {
    //         showMessagebox("跳转到目录", "<br>路径: <input type='text' id='dirname' value='" + htmlencode(now_dir) + "' style='width:190px' tabindex='30'><br><br><br><button id='btn_submit' type='submit' onclick='goTo_submit();' tabindex='20'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='21'><span><em> 取 消 </em></span></button>");
    //         $("dirname").focus();
    //
    //         if (isIE) {
    //             $("btn_submit").onclick = function () {
    //                 goTo_submit();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //             };
    //         }
    //     }
    //
    //     function goTo_submit() {
    //         ajaxRequest("chdir", "dir=" + urlEncode(htmldecode($("dirname").value)));
    //         top.closewindow();
    //     }
    //
        function goHome() {
            ajaxRequest("chdir", "dir=/");
        }
    //
    //     function changeDirectory(obj) {
    //         var selectedDir = obj.options[obj.selectedIndex].value;
    //         if (selectedDir != null && selectedDir != "") {
    //             ajaxRequest("chdir", "dir=" + urlEncode(htmldecode(selectedDir)));
    //         }
    //     }
    //
        function Refresh() {
            ajaxRequest("dir", 'r=' + Math.random());
        }
    //
    //     function selectTime() {
    //         var strMyDate = "";
    //         var strMyTime = "";
    //
    //         var timevalue = $("expiretime").value;
    //         if (timevalue != "") {
    //             var timeArray = timevalue.split(" ");
    //             strMyDate = timeArray[0];
    //             strMyTime = timeArray[1];
    //         }
    //         var frametag = new Date().getTime();
    //         showMessagebox("选择时间", "<iframe src='select_time.html?mydate=" + strMyDate + "&mytime=" + strMyTime + "&seeds=" + Math.random() + "' width=320 height=320 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", selectTime_callback, 320, 320);
    //     }
    //
    //     function selectTime_callback(str) {
    //         if (str != "" && str != null)
    //             $("expiretime").value = str;
    //     }
    //
    //     function formatLimitNumber(numbervalue) {
    //         $("downloadlimit").value = numbervalue.replace(/\D/g, '');
    //     }
    //
    //     function clearTime() {
    //         $("expiretime").value = "";
    //     }
    //
    //     function showDownloadUrl() {
    //         if (selectedRow == null) {
    //             alert("请选择一个文件或文件夹");
    //             return;
    //         }
    //
    //         var f_name = selectedRow.cells[0].getAttribute("name");
    //
    //         showMessagebox("使用Web外链下载", "<table width='100%' border='0' cellpadding='2' cellspacing='3'><tr><td style='padding-left:10px;padding-top:15px;' colspan=2><input type='checkbox' id='enable_weblink' onclick='clickWeblink();' tabindex='34'> <b>启用Web外链</b></td></tr><tr><td style='padding-left:10px;' colspan=2><textarea id='weblink_text' style='width:480px;height:85px' disabled tabindex='35'> </textarea></td></tr><tr><td style='padding-left:10px;width:140px;'>过期时间:</td><td><input id='expiretime' type='text' value='' disabled onclick='selectTime();' style='width:150px;' readonly tabindex='36'> <span><em><img src='images/clean.gif' align='absmiddle' id='btn_clear_date' onclick='clearTime();' title='Clean' style='border: 1px solid #666; padding:0px; cursor:pointer;' tabindex='37'>&nbsp;</em></span> (可选)</td></tr><tr><td style='padding-left:10px; width:110px;'>最大下载次数:</td><td><input id='downloadlimit' type='text' maxlength='6' value='' disabled onkeyup='formatLimitNumber(this.value);' onafterpaste='formatLimitNumber(this.value);' style='width:150px;' tabindex='38'> (可选)</td></tr><tr><td style='padding-left:10px; width:110px;'>密 码:</td><td><input id='downloadpass' type='text' maxlength='30' value='' disabled style='width:150px;' tabindex='39'> <button onclick='generateRandom();' title='生成一个随机的密码'><span style='vertical-align:middle;'><em><img src='images/password.gif' align='absmiddle'>&nbsp;</em></span></button> (可选)</td></tr><tr><td style='padding-left:6px;'><input type='checkbox' id='enable_sendmail' tabindex='40' onclick='enableSendMail();' value='1' disabled> 发送邮件到:</td><td><input id='mail_address' type='text' maxlength='256' tabindex='41' onblur=\"if(this.value=='') this.value='使用逗号分隔电子邮件地址'\" onfocus=\"if(this.value =='使用逗号分隔电子邮件地址' ) this.value=''\" value='使用逗号分隔电子邮件地址' style='width:320px;color:#898989;' disabled></td></tr><tr><td style='padding-left:30px;'>发送消息 (可选):</td><td><textarea id='mail_message' style='width:320px;height:35px' maxlength='1024' tabindex='43' disabled></textarea> </td></tr><tr><td style='padding-left:30px;'>我的邮件地址:</td><td><input id='sender_mail_address' type='text' maxlength='80' tabindex='42' style='width:180px; color:#898989;' disabled> (可选)</td></tr><tr align='center'><td height='50' colspan=2><button id='btn_submit' type='submit' onclick='update_weblink();' tabindex='44'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='45'><span><em>关闭窗口</em></span></button></td></tr></table>", null, 530, 400);
    //
    //         $("enable_weblink").focus();
    //
    //         ajaxRequest("weblink", "operation=get&filename=" + urlEncode(f_name));
    //
    //         if (isIE) {
    //             $("enable_weblink").onclick = function () {
    //                 clickWeblink();
    //             };
    //             $("expiretime").onclick = function () {
    //                 selectTime();
    //             };
    //             $("btn_clear_date").onclick = function () {
    //                 clearTime();
    //             };
    //             $("btn_submit").onclick = function () {
    //                 update_weblink();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //             };
    //         }
    //     }
    //
    //     function showUploadUrl() {
    //         if (selectedRow == null) {
    //             alert("请选择一个文件夹");
    //             return;
    //         }
    //
    //         if (selectedRow.cells[2].innerHTML != "文件夹") {
    //             alert("请选择一个文件夹");
    //             return;
    //         } else {
    //             var f_name = selectedRow.cells[0].getAttribute("name");
    //
    //             showMessagebox("创建文件上传请求", "<table width='100%' border='0' cellpadding='2' cellspacing='3'><tr><td style='padding-left:10px;padding-top:15px;' colspan=2><input type='checkbox' id='enable_uploadlink' onclick='clickUploadLink();' tabindex='34'> <b>启用文件请求链接</b></td></tr><tr><td style='padding-left:10px;' colspan=2><textarea id='uploadlink_text' style='width:480px;height:85px' disabled tabindex='35'> </textarea></td></tr><tr><td style='padding-left:10px;width:140px;'>过期时间:</td><td><input id='expiretime' type='text' value='' disabled onclick='selectTime();' style='width:150px;' readonly tabindex='36'> <span><em><img src='images/clean.gif' align='absmiddle' id='btn_clear_date' onclick='clearTime();' title='Clean' style='border: 1px solid #666; padding:0px; cursor:pointer;' tabindex='37'>&nbsp;</em></span> (可选)</td></tr><tr><td style='padding-left:10px; width:110px;'>密 码:</td><td><input id='downloadpass' type='text' maxlength='30' value='' disabled style='width:150px;' tabindex='39'> <button onclick='generateRandom();' title='生成一个随机的密码'><span style='vertical-align:middle;'><em><img src='images/password.gif' align='absmiddle'>&nbsp;</em></span></button> (可选)</td></tr><tr><td style='padding-left:6px;'><input type='checkbox' id='enable_sendmail' tabindex='40' onclick='enableSendMail();' value='1' disabled> 发送邮件到:</td><td><input id='mail_address' type='text' maxlength='256' tabindex='41' onblur=\"if(this.value=='') this.value='使用逗号分隔电子邮件地址'\" onfocus=\"if(this.value =='使用逗号分隔电子邮件地址' ) this.value=''\" value='使用逗号分隔电子邮件地址' style='width:320px;color:#898989;' disabled></td></tr><tr><td style='padding-left:30px;'>发送消息 (可选):</td><td><textarea id='mail_message' style='width:320px;height:35px' maxlength='1024' tabindex='42' disabled></textarea> </td></tr><tr><td style='padding-left:30px;'>我的邮件地址:</td><td><input id='sender_mail_address' type='text' maxlength='80' tabindex='43' style='width:180px; color:#898989;' disabled> (可选)</td></tr><tr><td style='padding-left:30px;display:none' colspan=2><input type='checkbox' id='enable_notify' tabindex='44' value='1' disabled> 当有人上传文件时向我发送通知邮件</td></tr><tr align='center'><td height='50' colspan=2><button id='btn_submit' type='submit' onclick='update_uploadlink();' tabindex='45'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='46'><span><em>关闭窗口</em></span></button></td></tr></table>", null, 530, 400);
    //
    //             $("enable_uploadlink").focus();
    //
    //             ajaxRequest("uplink", "operation=get&filename=" + urlEncode(f_name));
    //
    //             if (isIE) {
    //                 $("enable_uploadlink").onclick = function () {
    //                     clickUploadLink();
    //                 };
    //                 $("expiretime").onclick = function () {
    //                     selectTime();
    //                 };
    //                 $("btn_clear_date").onclick = function () {
    //                     clearTime();
    //                 };
    //                 $("btn_submit").onclick = function () {
    //                     update_uploadlink();
    //                 };
    //                 $("btn_cancel").onclick = function () {
    //                     top.closewindow();
    //                 };
    //             }
    //         }
    //     }
    //
    //     function enableSendMail() {
    //         if ($("enable_sendmail").checked) {
    //
    //             alert("请先在域的常规设置中选择一个SMTP配置选项.");
    //
    //         } else {
    //             $("mail_address").disabled = true;
    //             $("mail_message").disabled = true;
    //             $("sender_mail_address").disabled = true;
    //         }
    //     }
    //
    //
    //     function update_uploadlink() {
    //         var f_name = selectedRow.cells[0].getAttribute("name");
    //         var expiretime = htmldecode($("expiretime").value);
    //         var downloadpass = htmldecode($("downloadpass").value);
    //         var sendmail = ($("enable_sendmail").checked ? "yes" : "");
    //         var notify = ($("enable_notify").checked ? "yes" : "");
    //
    //         var mailaddress = htmldecode($("mail_address").value);
    //         if (mailaddress == "使用逗号分隔电子邮件地址") {
    //             mailaddress = "";
    //         }
    //         var sender_mailaddress = htmldecode($("sender_mail_address").value);
    //         var mail_message = htmldecode($("mail_message").value);
    //         var localaddress = weblink_url;
    //         if (localaddress == "")
    //             localaddress = window.location.protocol + '//' + window.location.host;
    //
    //         if ($("enable_uploadlink").checked) {
    //             ajaxRequest("uplink_update", "filename=" + urlEncode(f_name) + "&sendmail=" + sendmail + "&mailaddress=" + urlEncode(mailaddress) + "&sender_mailaddress=" + urlEncode(sender_mailaddress) + "&mail_message=" + urlEncode(mail_message) + "&localaddress=" + urlEncode(localaddress) + "&expiretime=" + urlEncode(expiretime) + "&notify=" + notify + "&uploadpass=" + urlEncode(downloadpass) + "&r=" + Math.random());
    //         }
    //         top.closewindow();
    //     }
    //
    //     function uplink_update_result() {
    //         var result = xmlhttp.responseText;
    //         if (trim(result) == "Error: sending email") {
    //             alert("操作失败: 发送电子邮件失败");
    //         } else if (trim(result) == "Error: no permission") {
    //             alert("操作失败: 没有权限或超出配额");
    //         } else if (trim(result) == "operation successful") {
    //             alert("操作成功!");
    //         }
    //     }
    //
    //     function clickUploadLink() {
    //         if ($("enable_uploadlink").checked) {
    //             var f_name = selectedRow.cells[0].getAttribute("name");
    //             ajaxRequest("uplink", "operation=add&filename=" + urlEncode(f_name));
    //         } else {
    //             var f_name = selectedRow.cells[0].getAttribute("name");
    //             ajaxRequest("uplink", "operation=del&filename=" + urlEncode(f_name));
    //         }
    //     }
    //
    //     function uplink() {
    //         var result = xmlhttp.responseText;
    //         try {
    //             if (trim(result) == "") {
    //             } else if (trim(result) == "noperm") {
    //                 alert("操作失败: 没有权限或超出配额");
    //
    //                 $("enable_uploadlink").checked = false;
    //                 $("uploadlink_text").value = "";
    //                 $("uploadlink_text").disabled = true;
    //                 $("expiretime").disabled = true;
    //                 $("enable_notify").disabled = true;
    //                 $("downloadpass").disabled = true;
    //                 $("enable_sendmail").disabled = true;
    //                 $("mail_address").disabled = true;
    //                 $("mail_message").disabled = true;
    //                 $("sender_mail_address").disabled = true;
    //             } else if (trim(result) == "deleted") {
    //                 $("enable_uploadlink").checked = false;
    //                 $("uploadlink_text").value = "";
    //                 $("uploadlink_text").disabled = true;
    //                 $("expiretime").disabled = true;
    //                 $("enable_notify").disabled = true;
    //                 $("downloadpass").disabled = true;
    //                 $("enable_sendmail").disabled = true;
    //                 $("mail_address").disabled = true;
    //                 $("mail_message").disabled = true;
    //                 $("sender_mail_address").disabled = true;
    //             } else {
    //                 var f_name = selectedRow.cells[0].getAttribute("name");
    //                 var filename = urlEncodeSpecial(f_name);
    //
    //                 $("enable_uploadlink").checked = true;
    //                 $("uploadlink_text").disabled = false;
    //                 $("expiretime").disabled = false;
    //                 $("enable_notify").disabled = false;
    //                 $("downloadpass").disabled = false;
    //                 $("enable_sendmail").disabled = false;
    //
    //                 var localaddress = weblink_url;
    //                 if (localaddress == "")
    //                     localaddress = window.location.protocol + '//' + window.location.host;
    //
    //                 var strWebLink = trim(result);
    //                 if (result.indexOf("\r\n") != -1) {
    //                     var resultArray = result.split("\r\n");
    //                     strWebLink = resultArray[0];
    //
    //                     if (resultArray[2] >= 0)
    //                         $("expiretime").value = translateTime(resultArray[2]);
    //                     else
    //                         $("expiretime").value = "";
    //
    //                     if (resultArray[3] != null && resultArray[3] != "")
    //                         $("downloadpass").value = resultArray[3];
    //                     else
    //                         $("downloadpass").value = "";
    //
    // //				if(resultArray[4] != null && resultArray[4] != "")
    // //					$("mail_address").value = resultArray[4];
    // //				else
    // //					$("mail_address").value = "";
    // //
    // //				if(resultArray[5] != null && resultArray[5] != "")
    // //					$("sender_mail_address").value = resultArray[5];
    // //				else
    // //					$("sender_mail_address").value = "";
    // //
    // //				if(resultArray[5] != null && trim(resultArray[5]) == "yes")
    // //					$("enable_notify").checked = true;
    // //				else
    // //					$("enable_notify").checked = false;
    //
    //                 }
    //
    //                 $("expiretime").style.color = "#000000";
    //
    //                 if ($("expiretime").value != "") {
    //                     if (compareDate($("expiretime").value) == true)
    //                         $("expiretime").style.color = "#FF0000";
    //                 }
    //                 $("uploadlink_text").value = localaddress + "/uploadlink.html?linkid=" + strWebLink;
    //             }
    //         } catch (e) {
    //         }
    //     }
    //
    //
    //     function update_weblink() {
    //         var f_name = selectedRow.cells[0].getAttribute("name");
    //         var expiretime = htmldecode($("expiretime").value);
    //         var downloadlimit = htmldecode($("downloadlimit").value);
    //         var downloadpass = htmldecode($("downloadpass").value);
    //         var sendmail = ($("enable_sendmail").checked ? "yes" : "");
    //
    //         var mailaddress = htmldecode($("mail_address").value);
    //         if (mailaddress == "使用逗号分隔电子邮件地址") {
    //             mailaddress = "";
    //         }
    //         var sender_mailaddress = htmldecode($("sender_mail_address").value);
    //         var mail_message = htmldecode($("mail_message").value);
    //         var localaddress = weblink_url;
    //         if (localaddress == "")
    //             localaddress = location.href.replace(/\#/g, "");
    //
    //         if ($("enable_weblink").checked) {
    //             ajaxRequest("weblink_update", "filename=" + urlEncode(f_name) + "&sendmail=" + sendmail + "&mailaddress=" + urlEncode(mailaddress) + "&sender_mailaddress=" + urlEncode(sender_mailaddress) + "&mail_message=" + urlEncode(mail_message) + "&localaddress=" + urlEncode(localaddress) + "&expiretime=" + urlEncode(expiretime) + "&downloadlimit=" + urlEncode(downloadlimit) + "&downloadpass=" + urlEncode(downloadpass) + "&r=" + Math.random());
    //         }
    //         top.closewindow();
    //     }
    //
    //     function weblink_update_result() {
    //         var result = xmlhttp.responseText;
    //         if (trim(result) == "Error: sending email") {
    //             alert("操作失败: 发送电子邮件失败");
    //         } else if (trim(result) == "Error: no permission") {
    //             alert("操作失败: 没有权限或超出配额");
    //         } else if (trim(result) == "operation successful") {
    //             alert("操作成功!");
    //         }
    //     }
    //
    //     function clickWeblink() {
    //         if ($("enable_weblink").checked) {
    //             var f_name = selectedRow.cells[0].getAttribute("name");
    //             ajaxRequest("weblink", "operation=add&filename=" + urlEncode(f_name));
    //         } else {
    //             var f_name = selectedRow.cells[0].getAttribute("name");
    //             ajaxRequest("weblink", "operation=del&filename=" + urlEncode(f_name));
    //         }
    //     }
    //
    //     function weblink() {
    //         var result = xmlhttp.responseText;
    //         try {
    //             if (trim(result) == "") {
    //             } else if (trim(result) == "noperm") {
    //                 alert("操作失败: 没有权限或超出配额");
    //
    //                 $("enable_weblink").checked = false;
    //                 $("weblink_text").value = "";
    //                 $("weblink_text").disabled = true;
    //                 $("expiretime").disabled = true;
    //                 $("downloadlimit").disabled = true;
    //                 $("downloadpass").disabled = true;
    //                 $("enable_sendmail").disabled = true;
    //                 $("mail_address").disabled = true;
    //                 $("mail_message").disabled = true;
    //             } else if (trim(result) == "deleted") {
    //                 $("enable_weblink").checked = false;
    //                 $("weblink_text").value = "";
    //                 $("weblink_text").disabled = true;
    //                 $("expiretime").disabled = true;
    //                 $("downloadlimit").disabled = true;
    //                 $("downloadpass").disabled = true;
    //                 $("enable_sendmail").disabled = true;
    //                 $("mail_address").disabled = true;
    //                 $("mail_message").disabled = true;
    //             } else {
    //                 var f_name = selectedRow.cells[0].getAttribute("name");
    //                 var filename = urlEncodeSpecial(f_name);
    //
    //                 $("enable_weblink").checked = true;
    //                 $("weblink_text").disabled = false;
    //                 $("expiretime").disabled = false;
    //                 $("downloadlimit").disabled = false;
    //                 $("downloadpass").disabled = false;
    //                 $("enable_sendmail").disabled = false;
    //                 //$("mail_address").disabled = false;
    //
    //                 var localaddress = weblink_url;
    //                 if (localaddress == "")
    //                     localaddress = location.href.replace(/\#/g, "");
    //
    //                 var strWebLink = trim(result);
    //                 if (result.indexOf("\r\n") != -1) {
    //                     var resultArray = result.split("\r\n");
    //                     strWebLink = resultArray[0];
    //                     if (resultArray[1] >= 0)
    //                         $("downloadlimit").value = resultArray[1];
    //                     else
    //                         $("downloadlimit").value = "";
    //
    //                     if (resultArray[2] >= 0)
    //                         $("expiretime").value = translateTime(resultArray[2]);
    //                     else
    //                         $("expiretime").value = "";
    //
    //                     if (resultArray[3] != null && resultArray[3] != "")
    //                         $("downloadpass").value = resultArray[3];
    //                     else
    //                         $("downloadpass").value = "";
    //
    //                 }
    //
    //                 $("downloadlimit").style.color = "#000000";
    //                 $("expiretime").style.color = "#000000";
    //
    //                 if ($("downloadlimit").value == "0")
    //                     $("downloadlimit").style.color = "#FF0000";
    //
    //                 if ($("expiretime").value != "") {
    //                     if (compareDate($("expiretime").value) == true)
    //                         $("expiretime").style.color = "#FF0000";
    //                 }
    //
    //                 if (selectedRow.cells[2].innerHTML == "文件夹")
    //                     $("weblink_text").value = localaddress + "?download&weblink=" + strWebLink;
    //                 else
    //                     $("weblink_text").value = localaddress + "?download&weblink=" + strWebLink + "&realfilename=" + filename;
    //             }
    //         } catch (e) {
    //         }
    //     }
    //
    //     function ed2kurl() {
    //         var ed2k_url = xmlhttp.responseText;
    //         ed2k_url = ed2k_url.replace("\n", "");
    //         try {
    //             if (trim(ed2k_url) == "") {
    //                 alert("服务器禁止了电驴下载链接!");
    //             } else {
    //                 var f_name = selectedRow.cells[0].getAttribute("name");
    //                 var filename = htmldecode(f_name);
    //                 filename = urlEncodeSpecial(f_name);
    //                 var localaddress = location.href.replace(/\#/g, "");
    //                 var downloadURL = localaddress + "?download&filename=" + filename + "&UID=fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229&nowpath=" + urlEncodeSpecial(now_dir) + "&r=" + Math.random();
    //                 $("urlcontent").value = "ed2k://|file|" + f_name + "|" + ed2k_url + "|s=" + downloadURL + "|/";
    //                 $("urltitle").innerHTML = "电驴下载地址:";
    //                 $("ed2kurl_btn").innerHTML = "<span><em>获取http下载地址</em></span>";
    //                 $("ed2kurl_btn").onclick = function () {
    //                     $("urlcontent").value = downloadURL;
    //                     $("urltitle").innerHTML = "http下载地址:";
    //                     $("ed2kurl_btn").innerHTML = "<span><em>获取电驴下载地址</em></span>";
    //                     $("ed2kurl_btn").onclick = function () {
    //                         ajaxRequest("ed2kurl", "filename=" + f_name);
    //                     }
    //                 }
    //             }
    //         } catch (e) {
    //         }
    //     }
    //
    //     function createFolder() {
    //         showMessagebox("创建文件夹", "<br>文件夹名称: <input type='text' id='newdirname' style='width:180px' maxlength='128' tabindex='30'><br><br><br><button id='btn_submit' type='submit' onclick='createFolder_submit()' tabindex='20'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='21'><span><em> 取 消 </em></span></button>");
    //         $("newdirname").focus();
    //
    //         if (isIE) {
    //             $("btn_submit").onclick = function () {
    //                 createFolder_submit();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //             };
    //         }
    //     }
    //
    //     function createFolder_submit() {
    //         var newname = htmldecode($("newdirname").value);
    //         if (newname.search(/[\\\/\<\>\:\?\"\|\*]/i) != -1) {
    //             alert("名称中含有非法的字符!");
    //             return false;
    //         } else if (newname == "") {
    //             alert("文件夹名称不能为空!");
    //             return false;
    //         }
    //         ajaxRequest("mkdir", "dir=" + urlEncode(newname));
    //     }
    //
    //     function renameFile() {
    //         if (selectedRow == null) {
    //             alert("请选择一个文件或文件夹");
    //             return;
    //         }
    //
    //         var f_name = selectedRow.cells[0].getAttribute("name");
    //         var filename = htmldecode(f_name);
    //
    //         showMessagebox("文件重命名", "<br><span style='width:110px;display:-moz-inline-box;display:inline-block;'>旧的名称:</span><input type='text' style='width:180px' id='oldname' value='" + htmlencode(filename) + "' disabled><br><span style='width:110px;display:-moz-inline-box;display:inline-block;'>新的名称:</span><input type='text' style='width:180px' id='newname' tabindex='30' value='" + htmlencode(filename) + "' maxlength='128'><br><br><button id='btn_submit' type='submit' onclick='return renameFile_submit()' tabindex='20'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='21'><span><em> 取 消 </em></span></button>");
    //         $("newname").focus();
    //
    //         if (isIE) {
    //             $("btn_submit").onclick = function () {
    //                 renameFile_submit();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //             };
    //         }
    //     }
    //
    //     function renameFile_submit() {
    //         var oldname = htmldecode($("oldname").value);
    //         var newname = htmldecode($("newname").value);
    //         if (oldname == newname) {
    //             closewindow();
    //             return true;
    //         }
    //         if (newname.search(/[\\\/\<\>\:\?\"\|\*]/i) != -1) {
    //             alert("名称中含有非法的字符!");
    //             return false;
    //         }
    //         ajaxRequest("rename", "oldname=" + urlEncode(oldname) + "&newname=" + urlEncode(newname));
    //         return true;
    //     }
    //
    //
    //     function checkUpload() {
    //         var xmlhttpObj = isIE ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();
    //         var url = "checkupload.html?r=" + Math.random();
    //         xmlhttpObj.open("GET", url, false);
    //         xmlhttpObj.send("");
    //
    //         var result = xmlhttpObj.responseText;
    //         if (result == EXPTag) {
    //             sess_expire();
    //         } else if (result != "") {
    //             alert(result);
    //         } else {
    //             var isFormDataSupported = !!window.FormData;
    //             var isFlashInstalled = DetectFlashVer(11, 4, 0);
    //             if (isFormDataSupported == false && isFlashInstalled == false) {
    //                 uploadOneFile();
    //             } else {
    //                 uploadFile();
    //             }
    //         }
    //     }
    //
    //
    //     function uploadFile() {
    //         var frametag = new Date().getTime();
    //         showMessagebox("上传文件", "<iframe src='uploader.html?r=" + Math.random() + "' width=700 height=390 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", closeUploader, 700, 390);
    //     }
    //
    //     function uploadOneFile() {
    //         showMessagebox("上传文件", "<br><form method='post' name='uploadform' id='uploadform' onsubmit='return uploadStart();' enctype='multipart/form-data' action='uploadok.html' target='hiddenframe'><input name='filename' type='file' size='20' id='filename' tabindex='30'><br><br><br><button id='btn_submit' type='submit' tabindex='20'><span><em> 上 传 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();return false;' tabindex='21'><span><em> 取 消 </em></span></button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</form>", cancelUpload);
    //         $("btn_submit").focus();
    //
    //         if (isIE) {
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //                 return false;
    //             };
    //         }
    //     }
    //
    //     function closeUploader() {
    //         if (last_field == -1)
    //             window.location = "main.html";
    //         else
    //             window.location = "main.html?sort=" + last_field + "&r=" + Number(reverse_sort);
    //
    //         return false;
    //     }
    //
    //     function cancelUpload() {
    //         if (uploading == true) {
    //             if (confirm("你确定要停止上传吗?")) {
    //                 if (last_field == -1)
    //                     window.location = "main.html";
    //                 else
    //                     window.location = "main.html?sort=" + last_field + "&r=" + Number(reverse_sort);
    //
    //                 return true;
    //             } else {
    //                 return false;
    //             }
    //         }
    //         return true;
    //     }
    //
    //
    //     function checkOverwrite(filename, totalfiles) {
    //         if (auto_overwrite == true)
    //             return "1";
    //
    //         try {
    //             totalfiles = parseInt(totalfiles);
    //         } catch (e) {
    //             totalfiles = 1;
    //         }
    //
    //         var overwrite = false;
    //         var upFilename = htmlencode(filename);
    //         var listtableRows = $("listtable").tBodies[0].rows;
    //         for (var i = 0; i < listtableRows.length; i++) {
    //             if (upFilename == listtableRows[i].cells[0].getAttribute("name")) {
    //                 overwrite = true;
    //                 break;
    //             }
    //         }
    //         if (overwrite == true && confirm("文件已经存在,确定要覆盖它吗? (" + listtableRows[i].cells[0].getAttribute("name") + ")") == false) {
    //             return "0";
    //         }
    //
    //         if (totalfiles > 1 && overwrite == true && confirm("总是自动覆盖吗?") == true)
    //             auto_overwrite = true;
    //
    //         return "1";
    //     }
    //
    //     function uploadStart() {
    //         if (uploading == false) {
    //             if ($("filename").value == "") {
    //                 alert("请选择一个要上传的文件!");
    //                 return false;
    //             } else {
    //                 upload_filename = "";
    //                 var tmpname = $("filename").value;
    //                 if (tmpname.lastIndexOf("\\") != -1)
    //                     upload_file = tmpname.substr(tmpname.lastIndexOf("\\") + 1);
    //                 else if (tmpname.lastIndexOf("\/") != -1)
    //                     upload_file = tmpname.substr(tmpname.lastIndexOf("\/") + 1);
    //                 else
    //                     upload_file = tmpname;
    //             }
    //
    //             var overwrite = false;
    //             var upFilename = htmlencode(upload_file);
    //             var listtableRows = $("listtable").tBodies[0].rows;
    //             for (var i = 0; i < listtableRows.length; i++) {
    //                 if (upFilename == listtableRows[i].cells[0].getAttribute("name")) {
    //                     overwrite = true;
    //                     break;
    //                 }
    //             }
    //             if (overwrite == true && confirm("文件已经存在,确定要覆盖它吗?") == false) {
    //                 return false;
    //             }
    //
    //             uploading = true;
    //             $("uploadingDiv").style.display = "";
    //             $("uploadingDiv").innerHTML = "文件上传中<img src='images/loading.gif'>";
    //             $("uploadingDiv").focus();
    //
    //             setTimeout("idleupload()", 3000);
    //             d = new Date();
    //             start_time = d.getTime();
    //             last_uploadsize = 0;
    //             last_lefttime = -1;
    //             return true;
    //         } else {
    //             return false;
    //         }
    //     }
    //
    //     function idleupload() {
    //         clearInterval(_TIMER_UPLOADING);
    //         _TIMER_UPLOADING = setInterval("uploadRefresh()", 2000);
    //     }
    //
    //     function uploadEnd() {
    //         try {
    //             uploading = false;
    //             upload_file = "";
    //             upload_filename = "";
    //             clearInterval(_TIMER_UPLOADING);
    //             $("uploadingDiv").style.display = "none";
    //             $("uploadform").reset();
    //             location.reload();
    //
    //         } catch (e) {
    //         }
    //     }
    //
    //     function uploadEnd_ok() {
    //         try {
    //             uploading = false;
    //             upload_file = "";
    //             upload_filename = "";
    //             clearInterval(_TIMER_UPLOADING);
    //             $("uploadingDiv").style.display = "none";
    //             $("uploadform").reset();
    //
    //
    //         } catch (e) {
    //         }
    //     }
    //
    //     function editFile() {
    //         if (selectedRow == null) {
    //             alert("请选择一个文件或文件夹");
    //             return;
    //         }
    //
    //         if (selectedRow.cells[2].innerHTML == "文件夹") {
    //             alert("请选择一个文件");
    //             return;
    //         } else {
    //             var f_name = selectedRow.cells[0].getAttribute("name");
    //             var filename = htmldecode(f_name);
    //             var frametag = new Date().getTime();
    //             showMessagebox("<span title='" + htmlencode(f_name) + "'>" + htmlencode(f_name).substr(0, 55) + (f_name.length > 55 ? "..." : "") + "</span>", "<iframe src='editor.html?dir=" + urlEncodeSpecial(now_dir) + "&filename=" + urlEncodeSpecial(filename) + "&r=" + Math.random() + "' width=720 height=520 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 720, 520);
    //         }
    //     }
    //
    //     function checkvideo() {
    //         return !!document.createElement('video').canPlayType;
    //     }
    //
    //     function checkaudio() {
    //         return !!document.createElement('audio').canPlayType;
    //     }
    //
    //     function checkFilePermission(url) {
    //         var xmlhttpObj = isIE ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();
    //         xmlhttpObj.open("GET", url, false);
    //         xmlhttpObj.send("");
    //
    //         var result = trim(xmlhttpObj.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return false;
    //         } else if (result != "") {
    //             alert(result);
    //             return false;
    //         } else {
    //             return true;
    //         }
    //     }
    //
    //     function downloadFile() {
    //         if (selectedRow == null) {
    //             alert("请选择一个文件或文件夹");
    //             return;
    //         }
    //
    //         var f_name = selectedRow.cells[0].getAttribute("name");
    //         var f_name2 = htmldecode(f_name);
    //         var f_ext = getExtention(f_name2);
    //         var filename = urlEncodeSpecial(f_name2);
    //         var filesize = selectedRow.cells[0].getAttribute("fsize");
    //
    //         var checkfileURL = "checkdownload.html?filename=" + filename + "&filesize=" + filesize + "&r=" + Math.random();
    //
    //         if (f_ext == "gif" || f_ext == "png" || f_ext == "jpg" || f_ext == "jpeg" || f_ext == "bmp") {
    //             if (checkFilePermission(checkfileURL)) {
    //                 show_picture(filename);
    //             }
    //         } else if (!isIE && f_ext == "pdf") {
    //             if (checkFilePermission(checkfileURL)) {
    //                 var frametag = new Date().getTime();
    //                 var pdf_url = encodeURIComponent("/?download&filename=" + filename + "&UID=fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229&r=" + Math.random());
    //                 showMessagebox("<span title='" + htmlencode(f_name) + "'>" + htmlencode(f_name.substr(0, 85)) + (f_name.length > 85 ? "..." : "") + "</span>", "<iframe src='/pdfjs-dist/web/viewer.html?file=" + pdf_url + "' width=1120 height=760 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 1120, 760);
    //             }
    //         } else if (checkvideo() && (f_ext == "mp4" || f_ext == "mov")) {
    //             if (checkFilePermission(checkfileURL)) {
    //                 var frametag = new Date().getTime();
    //                 showMessagebox("<span title='" + htmlencode(f_name) + "'>" + htmlencode(f_name.substr(0, 85)) + (f_name.length > 85 ? "..." : "") + "</span>", "<iframe src='videoplayer.html?dir=" + urlEncodeSpecial(now_dir) + "&filename=" + filename + "&r=" + Math.random() + "' width=980 height=560 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 980, 560);
    //             }
    //         } else if (checkaudio() && (f_ext == "mp3" || f_ext == "ogg" || f_ext == "wav")) {
    //             if (checkFilePermission(checkfileURL)) {
    //                 var frametag = new Date().getTime();
    //                 showMessagebox("<span title='" + htmlencode(f_name) + "'>" + htmlencode(f_name.substr(0, 45)) + (f_name.length > 45 ? "..." : "") + "</span>", "<iframe src='audioplayer.html?dir=" + urlEncodeSpecial(now_dir) + "&filename=" + filename + "&r=" + Math.random() + "' width=620 height=320 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 620, 320);
    //             }
    //         } else if (enable_online_edit == "1" && (f_ext == "txt" || f_ext == "cpp" || f_ext == "c" || f_ext == "h" || f_ext == "hpp" || f_ext == "lua" || f_ext == "sh" || f_ext == "java" || f_ext == "xml" || f_ext == "html" || f_ext == "htm" || f_ext == "js" || f_ext == "css" || f_ext == "php" || f_ext == "jsp" || f_ext == "asp" || f_ext == "pl" || f_ext == "py")) {
    //             if (checkFilePermission(checkfileURL)) {
    //                 var frametag = new Date().getTime();
    //                 showMessagebox("<span title='" + htmlencode(f_name) + "'>" + htmlencode(f_name.substr(0, 55)) + (f_name.length > 55 ? "..." : "") + "</span>", "<iframe src='editor.html?dir=" + urlEncodeSpecial(now_dir) + "&filename=" + filename + "&r=" + Math.random() + "' width=720 height=520 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 720, 520);
    //             }
    //         } else {
    //             download_url = "/?download&filename=" + filename + "&UID=fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229&r=" + Math.random();
    //             if (isIE)
    //                 checkDownload("checkdownload.html?filename=" + filename + "&filesize=" + filesize + "&r=" + Math.random());
    //             else
    //                 ajaxRequest("checkdownload", "filename=" + filename + "&filesize=" + filesize + "&r=" + Math.random());
    //         }
    //     }
    //
    /**
     * 下载外部文件？？
     *
     */
    function downloadFile_ext() {
        //未选择时报xxx
        if (selectedRow == null) {
            alert("请选择一个文件或文件夹");
            return;
        }
        //当选中了"文件夹"时
        if (selectedRow.cells[2].innerHTML == "文件夹") {
            //打开目录，进入新的url
            openDirectory()
        } else {
            var f_name = selectedRow.cells[0].getAttribute("name");
            var filename = htmldecode(f_name);
            filename = urlEncodeSpecial(filename);
            var filesize = selectedRow.cells[0].getAttribute("fsize");
            download_url = "/?download&filename=" + filename + "&UID=fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229&r=" + Math.random();
            if (isIE)
                checkDownload("checkdownload.html?filename=" + filename + "&filesize=" + filesize + "&r=" + Math.random());
            else
                ajaxRequest("checkdownload", "filename=" + filename + "&filesize=" + filesize + "&r=" + Math.random());
        }
    }

    //
    //     function checkDownload(url) {
    //         var xmlhttpObj = isIE ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();
    //         xmlhttpObj.open("GET", url, false);
    //         xmlhttpObj.send("");
    //
    //         var result = xmlhttpObj.responseText;
    //         if (result == EXPTag) {
    //             sess_expire();
    //         } else if (result != "") {
    //             alert(result);
    //         } else {
    //             window.open(download_url, "_self");
    //         }
    //     }
    //
    //     function deleteFile(multiple) {
    //         if (multiple == null || multiple == false || multiple == 0) {
    //             var checkedlist = getCheckedFilelist();
    //             if (checkedlist != "") {
    //                 if (selectedRow == null) {
    //                     deleteFile(1);
    //                     return;
    //                 } else {
    //                     alert("提示: 如果你想要执行多文件操作, 你需要点击位于右上角的按钮, 否则只需单击这个文件即可");
    //                 }
    //             }
    //
    //             if (selectedRow == null) {
    //                 alert("请选择一个文件或文件夹");
    //                 return;
    //             }
    //
    //             var filestring = "文件";
    //             var isdir = "0";
    //             if (selectedRow.cells[2].innerHTML == "文件夹") {
    //                 filestring = "文件夹";
    //                 isdir = "1";
    //             }
    //             var filename = htmldecode(selectedRow.cells[0].getAttribute("name"));
    //             if (confirm("确定要删除 '" + filestring + " " + filename + "' ?" + (isdir == "1" ? "\r\n(此操作将会删除该目录下的所有子目录和文件!)" : ""))) {
    //                 ajaxRequest("rmdir", "isdir=" + isdir + "&dir=" + urlEncode(filename));
    //                 selectedRow = null;
    //             }
    //         } else {
    //             var dirlist = getCheckedDirlist(1);
    //             var filelist = getCheckedDirlist(0);
    //             if (dirlist == "" && filelist == "") {
    //                 alert("执行多文件操作时, 至少要勾选一个勾选框(checkbox).");
    //                 return false;
    //             } else {
    //                 if (confirm("确认要删除这些目录(文件)以及他们的子目录(文件)吗 ? ")) {
    //                     ajaxRequest("rmdirfile", "dirlist=" + urlEncode(dirlist) + "&filelist=" + urlEncode(filelist));
    //                     unselectAll();
    //                 }
    //             }
    //         }
    //     }
    //
    //     function cutFile(multiple) {
    //         var filename = "";
    //         if (multiple == null || multiple == false || multiple == 0) {
    //             var checkedlist = getCheckedFilelist();
    //             if (checkedlist != "") {
    //                 alert("提示: 如果你想要执行多文件操作, 你需要点击位于右上角的按钮, 否则只需单击这个文件即可");
    //
    //                 if (selectedRow == null)
    //                     return;
    //             }
    //
    //             if (selectedRow == null) {
    //                 alert("请选择一个文件或文件夹");
    //                 return;
    //             }
    //
    //             filename = htmldecode(selectedRow.cells[0].getAttribute("name"));
    //         } else {
    //             filename = getCheckedFilelist();
    //             if (filename == "") {
    //                 alert("执行多文件操作时, 至少要勾选一个勾选框(checkbox).");
    //                 return false;
    //             }
    //         }
    //         ajaxRequest("cut", "filename=" + urlEncode(filename));
    //         selectedRow = null;
    //         unselectAll();
    //         $("pasteitem").style.display = "";
    //         $("pasteitem2").style.display = "";
    //         $("pasteitem3").style.display = "";
    //     }
    //
    //     function copyFile(multiple) {
    //         var filename = "";
    //         if (multiple == null || multiple == false || multiple == 0) {
    //             var checkedlist = getCheckedFilelist();
    //             if (checkedlist != "") {
    //                 alert("提示: 如果你想要执行多文件操作, 你需要点击位于右上角的按钮, 否则只需单击这个文件即可");
    //
    //                 if (selectedRow == null)
    //                     return;
    //             }
    //
    //             if (selectedRow == null) {
    //                 alert("请选择一个文件或文件夹");
    //                 return;
    //             }
    //
    //             filename = htmldecode(selectedRow.cells[0].getAttribute("name"));
    //         } else {
    //             filename = getCheckedFilelist();
    //             if (filename == "") {
    //                 alert("执行多文件操作时, 至少要勾选一个勾选框(checkbox).");
    //                 return false;
    //             }
    //         }
    //         ajaxRequest("copy", "filename=" + urlEncode(filename));
    //         selectedRow = null;
    //         unselectAll();
    //         $("pasteitem").style.display = "";
    //         $("pasteitem2").style.display = "";
    //         $("pasteitem3").style.display = "";
    //     }
    //
    //     function pasteFile() {
    //         ajaxRequest("paste", "");
    //     }
    //
    //     function changePassword() {
    //         showMessagebox("更改密码", "<br><table id='listhead2' width='100%' border='0' cellpadding='2' cellspacing='3'><tr><td style='padding-left:20px;'>旧密码: </td><td><input type='password' id='oldpassword' style='width:160px' tabindex='28'></td></tr><tr><td style='padding-left:20px;'>新密码: </td><td><input type='password' id='newpassword' style='width:160px' tabindex='29'><br><span style='font-size:9px;color:#777'>密码强度:<img src='images/pass_strength0.gif' id='pass_strength' border='0' align='absmiddle'></span></td></tr><tr><td style='padding-left:20px;'>新密码确认: </td><td><input type='password' id='newpass_confirm' style='width:160px' tabindex='30'></td><tr><td colspan=2 height=25>&nbsp;</td></tr><tr align='center'><td colspan=2><button id='btn_submit' type='submit' onclick='changePassword_submit()' tabindex='20'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.location.reload();' tabindex='21'><span><em> 取 消 </em></span></button></td></tr>", changePasswordCancel, 360, 220);
    //         $("oldpassword").focus();
    //
    //         if (isIE) {
    //             $("btn_submit").onclick = function () {
    //                 changePassword_submit();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.location.reload();
    //             };
    //         }
    //
    //         $("newpassword").onkeyup = inputPassword;
    //         $("newpassword").onafterpaste = inputPassword;
    //     }
    //
    //     function changePasswordCancel() {
    //         top.location.reload();
    //     }
    //
    //     function inputPassword() {
    //         var nPassStrong = checkPasswordStrong($("newpassword").value);
    //         if (nPassStrong <= 1) {
    //             $("pass_strength").src = "images/pass_strength1.gif";
    //         } else if (nPassStrong == 2 || nPassStrong == 3) {
    //             $("pass_strength").src = "images/pass_strength2.gif";
    //         } else {
    //             $("pass_strength").src = "images/pass_strength3.gif";
    //         }
    //     }
    //
    //     function changePassword_submit() {
    //         var oldpassword = $("oldpassword").value;
    //         var newpassword = $("newpassword").value;
    //         var newpass_confirm = $("newpass_confirm").value;
    //         if (newpassword != newpass_confirm) {
    //             alert("确认密码和新密码不一致,请重新输入.");
    //             return;
    //         }
    //
    //         //if(checkPasswordStrong(newpassword) < 2)
    //         //{
    //         //	if(confirm("[nil value]"))
    //         //		return;
    //         //}
    //
    //         ajaxRequest("changepass", "oldpassword=" + urlEncode(oldpassword) + "&newpassword=" + urlEncode(newpassword) + "&r=" + Math.random());
    //     }
    //
    //     function changepass() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         alert(result);
    //         top.location.reload();
    //     }
    //
    //     function checkdownload_Result() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //         } else if (result != "") {
    //             alert(result);
    //         } else {
    //             window.open(download_url, "_self");
    //         }
    //     }
    //


        function signOut() {
            if (confirm("确定要退出登录吗?")) {
                //window.location = "logout.html";
                // gotoUrl("logout.html");
                gotoUrl("jtyh.html");
            }
        }

    //     btnHover = function () {
    //         var buttonObj = document.body.getElementsByTagName("button");
    //         for (var i = 0; i < buttonObj.length; i++) {
    //             if (buttonObj[i].className != "mybutton") {
    //                 buttonObj[i].onmouseover = function () {
    //                     this.className = "buttonhover";
    //                 }
    //                 buttonObj[i].onmouseout = function () {
    //                     this.className = this.className.replace(/\bbuttonhover\b/, '');
    //                 }
    //             }
    //         }
    //     }
    //     if (window.attachEvent && isIE)
    //         window.attachEvent("onload", btnHover);
    //
    //
    //     function getLocation() {
    //         if (location.href.indexOf("main.html") == -1)
    //             return location.href + "/main.html";
    //         else
    //             return location.href;
    //     }
    //
    //     function getSessionID() {
    //         return "fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229";
    //     }
    //
    //     function getItemLabel(index) {
    //         index = parseInt(index);
    //         var strLable = new Array('上传文件', '名称', '大小', '状态',
    //             '正在上传', '等候上传', ' 上 传 ', ' 停止 ',
    //             '选择文件', '清除所有', '清除', '关闭窗口',
    //             '总的文件个数', '总的文件大小', '个文件剩余', '上传完成!',
    //             '切换到简单上传模式');
    //         return strLable[index];
    //     }
    //
    //     function closeUploadWindow() {
    //         $("uploadingDiv_mask").style.display = "none";
    //         $("uploadingDiv2").style.display = "none";
    //
    //         if (isFirefox) {
    //             goTo();
    //             top.closewindow();
    //         }
    //     }
    //
    //     function openSearch() {
    //         var frametag = new Date().getTime();
    //         showMessagebox("搜索服务器上的文件", "<iframe src='search.html?searchin=" + urlEncodeSpecial(now_dir) + "&r=" + Math.random() + "' width=620 height=430 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 620, 430);
    //     }
    //
    //     function checkPasswordStrong(password) {
    //         var nStrong = 0;
    //         var bSequence = true;
    //         var lastCharCode = -1;
    //         for (var i = 0; i < password.length; i++) {
    //             var charcode = password.charCodeAt(i);
    //             if (lastCharCode != -1 && charcode != (lastCharCode + 1)) {
    //                 bSequence = false;
    //                 break;
    //             }
    //             lastCharCode = charcode;
    //         }
    //
    //         if (password.match(/[0-9]/)) nStrong++;
    //         if (password.match(/[A-Z]/)) nStrong++;
    //         if (password.match(/[a-z]/)) nStrong++;
    //         if (password.match(/[@#$%&!*)(-+=^]/)) nStrong++;
    //         if (password.length >= 12) nStrong++;
    //         if (password.length <= 6) nStrong--;
    //         if (bSequence == true) nStrong--;
    //
    //         return nStrong;
    //     }
    //
    /**
     * 鼠标经过时的变化
     * @param obj
     */
    function menuMouseOver(obj) {
        obj.style.color = "#FFFFFF";
        obj.style.backgroundColor = "#1665CB";
        //cursor: pointer; 鼠标变成手；
        obj.style.cursor = "pointer";
    }

    /**
     * 鼠标离开时的变化
     * @param obj
     */
    function menuMouseOut(obj) {
        obj.style.backgroundColor = "#FFFFFF";
        obj.style.color = "#000000";
    }

    //
    //     function clickCheckbox(obj) {
    //         var id = obj.getAttribute("ccid");
    //         $("cid_" + id).checked = obj.checked;
    //     }
    //
    //
    //     function zipFile(multiple) {
    //         var filelist = "";
    //         if (multiple == null || multiple == false || multiple == 0) {
    //             var checkedlist = getCheckedFilelist();
    //             if (checkedlist != "") {
    //                 alert("提示: 如果你想要执行多文件操作, 你需要点击位于右上角的按钮, 否则只需单击这个文件即可");
    //
    //                 if (selectedRow == null)
    //                     return;
    //             }
    //
    //             if (selectedRow == null) {
    //                 alert("请选择一个文件或文件夹");
    //                 return;
    //             }
    //
    //             filelist = selectedRow.cells[0].getAttribute("name");
    //         } else {
    //             filelist = getCheckedFilelist();
    //             if (filelist == "") {
    //                 alert("执行多文件操作时, 至少要勾选一个勾选框(checkbox).");
    //                 return false;
    //             }
    //         }
    //
    //         showMessagebox("压缩文件(目录)到一个zip文件", "<br>Zip文件名: <input type='text' id='zipfilename' style='width:150px' maxlength=60 tabindex='30'>  .zip<br><br><br><span style='line-height:120%;width:310px;'><img src='images/warning.gif' align='absmiddle'>如果你有很多文件要压缩, 这个操作可能需要花几分钟.</span><br><br><input type='hidden' id='srcfilelist' value='" + htmlencode(filelist) + "'><button id='btn_submit' type='submit' onclick='zipFile_submit()' tabindex='20'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='21'><span><em> 取 消 </em></span></button>", null, 380, 220);
    //         $("zipfilename").focus();
    //
    //         if (isIE) {
    //             $("btn_submit").onclick = function () {
    //                 zipFile_submit();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //             };
    //         }
    //     }
    //
    //     function zipFile_submit() {
    //         var zipfilename = htmldecode($("zipfilename").value) + ".zip";
    //         if (zipfilename.search(/[\\\/\<\>\:\?\"\|\*]/i) != -1) {
    //             alert("名称中含有非法的字符!");
    //             return false;
    //         } else if (zipfilename == ".zip") {
    //             alert("文件名称不能为空!");
    //             return false;
    //         }
    //
    //         var listtableRows = $("listtable").tBodies[0].rows;
    //         for (var i = 0; i < listtableRows.length; i++) {
    //             if (zipfilename == listtableRows[i].cells[0].getAttribute("name")) {
    //                 alert("此文件已经存在,请更换一个文件名.");
    //                 return false;
    //             }
    //         }
    //
    //         var filelist = htmldecode($("srcfilelist").value);
    //         if (filelist == "") {
    //             alert("请选择至少一个源文件.");
    //             return false;
    //         }
    //         ajaxRequest("zip", "zipfile=" + urlEncode(zipfilename) + "&srcfiles=" + urlEncode(filelist));
    //         selectedRow = null;
    //         unselectAll();
    //     }
    //
    //     function unzipFile() {
    //         if (selectedRow == null) {
    //             alert("请选择一个文件或文件夹");
    //             return;
    //         }
    //
    //         var f_name = htmldecode(selectedRow.cells[0].getAttribute("name"));
    //         var file_ext = getExtention(f_name);
    //         if (selectedRow.cells[2].innerHTML == "文件夹" || file_ext != "zip") {
    //             alert("请选择一个zip文件.");
    //             return;
    //         }
    //
    //         if (confirm("如果zip文件很大的话, 解压缩操作就得花几分钟, 是否继续?"))
    //             ajaxRequest("unzip", "zipfile=" + urlEncode(f_name));
    //     }
    //
    //     function zip() {
    //         $("waitingdiv2").style.display = "none";
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         if (result == "")
    //             alert("压缩/解压缩成功!");
    //         else
    //             alert("压缩/解压缩失败: " + result);
    //         top.closewindow();
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function unzip() {
    //         $("waitingdiv2").style.display = "none";
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         if (result == "") {
    //             alert("压缩/解压缩成功!");
    //         } else {
    //             alert("压缩/解压缩失败: " + result);
    //         }
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function rmdirfile() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //         alert(result);
    //         ajaxRequest("dir", 'r=' + Math.random());
    //     }
    //
    //     function getCheckedDirlist(dir) {
    //         var filelist = "";
    //         var checkboxs = document.getElementsByTagName("input");
    //         for (var i = 0; i < checkboxs.length; i++) {
    //             if (checkboxs[i].type == "checkbox" && checkboxs[i].checked == true) {
    //                 try {
    //                     if (checkboxs[i].getAttribute("flag") == "list") {
    //                         var cid = checkboxs[i].getAttribute("cid");
    //                         if (dir == 1 && $("tr_" + cid).parentNode.cells[2].innerHTML == "文件夹") {
    //                             if (filelist != "") filelist += "||";
    //                             filelist += htmldecode($("tr_" + cid).getAttribute("name"));
    //                         }
    //                         if (dir == 0 && $("tr_" + cid).parentNode.cells[2].innerHTML != "文件夹") {
    //                             if (filelist != "") filelist += "||";
    //                             filelist += htmldecode($("tr_" + cid).getAttribute("name"));
    //                         }
    //                     }
    //                 } catch (e) {
    //                 }
    //             }
    //         }
    //         return filelist;
    //     }
    //
    //     function newText() {
    //         showMessagebox("创建文本文件", "<br>文件名: <input type='text' id='newfilename' style='width:150px' maxlength='128' tabindex='30'> .txt<br><br><br><button id='btn_submit' type='submit' onclick='newText_submit()' tabindex='20'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='21'><span><em> 取 消 </em></span></button>", null, 330, 180);
    //         $("newfilename").focus();
    //
    //         if (isIE) {
    //             $("btn_submit").onclick = function () {
    //                 newText_submit();
    //             };
    //             $("btn_cancel").onclick = function () {
    //                 top.closewindow();
    //             };
    //         }
    //     }
    //
    //     function newText_submit() {
    //         var newname = htmldecode($("newfilename").value) + ".txt";
    //         if (newname.search(/[\\\/\<\>\:\?\"\|\*]/i) != -1) {
    //             alert("名称中含有非法的字符!");
    //             return false;
    //         } else if (newname == ".txt") {
    //             alert("文件名称不能为空!");
    //             return false;
    //         }
    //         txt_filename = newname;
    //         ajaxRequest("mkfile", "filename=" + urlEncode(newname));
    //     }
    //
    //     function mkfile() {
    //         var result = trim(xmlhttp.responseText);
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //
    //         if (result != "") {
    //             alert(result);
    //         } else {
    //             top.closewindow();
    //             ajaxRequest("dir", 'r=' + Math.random());
    //
    //             var f_name = htmlencode(txt_filename);
    //             var filename = urlEncodeSpecial(txt_filename);
    //             var frametag = new Date().getTime();
    //             showMessagebox("<span title='" + f_name + "'>" + f_name.substr(0, 55) + (f_name.length > 55 ? "..." : "") + "</span>", "<iframe src='editor.html?dir=" + urlEncodeSpecial(now_dir) + "&filename=" + filename + "&r=" + Math.random() + "' width=720 height=520 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 720, 520);
    //         }
    //     }
    //
    //     function SetLastField(field) {
    //         if (last_field == field) {
    //             if (reverse_sort == 0)
    //                 reverse_sort = 1;
    //             else
    //                 reverse_sort = 0;
    //         } else {
    //             reverse_sort = 0;
    //         }
    //         last_field = field;
    //     }
    //
    //     function image_resize() {
    //         if (round(zoomval, 0) == 100) {
    //             resize_picture(false);
    //             $("lable2").title = "实际大小";
    //         } else {
    //             resize_picture(true);
    //             $("lable2").title = "合适尺寸";
    //         }
    //     }
    //
    //     function getBookmark() {
    //         var xmlhttpObj = isIE ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();
    //         var url = "bookmark.html?operation=get&r=" + Math.random();
    //         xmlhttpObj.open("GET", url, false);
    //         xmlhttpObj.send("");
    //
    //         var result = xmlhttpObj.responseText;
    //         if (result != "") {
    //             bookmark_show(result);
    //         }
    //     }
    //
    //     function addBookmark() {
    //         for (var i = 0; i < $("bookmark").options.length; i++) {
    //             if ($("bookmark").options[i].value == now_dir)
    //                 return false;
    //         }
    //
    //         ajaxRequest("bookmark", "operation=add&r=" + Math.random());
    //         return true;
    //     }
    //
    //     function delBookmark() {
    //         for (var i = 0; i < $("bookmark").options.length; i++) {
    //             if ($("bookmark").options[i].value == now_dir) {
    //                 ajaxRequest("bookmark", "operation=del&r=" + Math.random());
    //                 return true;
    //             }
    //         }
    //
    //         return false;
    //     }
    //
    //     function bookmark_result() {
    //         var result = xmlhttp.responseText;
    //         if (result == EXPTag) {
    //             sess_expire();
    //             return;
    //         }
    //
    //         bookmark_show(result);
    //     }
    //
    //     function bookmark_show(strResult) {
    //         try {
    //             var bookmarkArray = strResult.split("\n");
    //             $("bookmark").options.length = 0;
    //             $("bookmark").options[0] = new Option("=== 路径书签 ===", "");
    //             $("favorites_add").style.display = "";
    //             $("favorites_del").style.display = "none";
    //             for (var i = 0; i < bookmarkArray.length; i++) {
    //                 var strBookmark = bookmarkArray[i];
    //                 if (strBookmark != "") {
    //                     $("bookmark").options[i + 1] = new Option(strBookmark, strBookmark);
    //                     if (strBookmark == now_dir) {
    //                         $("favorites_add").style.display = "none";
    //                         $("favorites_del").style.display = "";
    //                     }
    //                 }
    //             }
    //         } catch (e) {
    //         }
    //     }


</script>

<!--最底层背景设置-->
<body style="background:#DAE9FC;margin:0px;padding:0px;">
<!--<body style="background: url(images/83.jpg) repeat-x;">-->
<!--不可见的各种图标-->
<div style="display:none">
    <img src='images/waiting.gif'>
    <img src='images/progress_border.gif'>
    <img src='images/progress_bar.gif'>
    <img src='images/loading.gif'>
    <img src='images/loading2.gif'>
</div>

<!--等待数据更新时的背景-->
<div id="waitingdiv"
     style="position:absolute; z-index:1000; top:0px; left:0px; width:100%; height:100%; background:#777; filter:alpha(opacity=60); opacity:0.60; display:none;"
     align="center">
    <div style="position:absolute; top:20%; left:40%; width:300px; height:100px;">
        <img src="images/loading2.gif" border="0">
        <H2><b>正在更新数据...</b></H2>
    </div>
</div>

<div id="waitingdiv2"
     style="position:absolute; z-index:999; top:0px; left:0px; width:100%; height:100%; background:#999; filter:alpha(opacity=60); opacity:0.60; display:none;"
     align="center">
    <div style="position:absolute; top:20%; left:25%; width:550px; height:150px;">
        <br/>
        <img src=" images/loading2.gif" border="0"/>
        <H2><b>正在处理中...<br>请不要关掉你的浏览器.</b></H2>
    </div>
</div>

<!--上传时的背景-->
<div id="cancelupload_div"
     style="position:absolute; z-index:200; top:0px; left:0px; width:100%; height:100%; background:#777; filter:alpha(opacity=60); opacity:0.60; display:none;"
     align="center">
    <div style="position:absolute; top:20%; left:40%; width:350px; height:100px;"><img src="images/loading2.gif"
                                                                                       border="0">
        <H2><b>正在取消上传,请稍候...</b></H2></div>
</div>

<!--灰色幕布-->
<div id="picturediv"
     style="position:absolute; z-index:102; top:0px;left:0px;z-index:101;width:100%;height:100%;background-color: #000;filter:alpha(opacity=80); opacity:0.80; display:none;"></div>
<!--四个图标，左右放大缩小 在中上方 默认隐藏，特定时间激活-->
<div id="picturediv2"
     style="position:absolute; z-index:103; width:100%; top:0px; left:0px; text-align:center; display:; overflow:auto;">
    <!--黑白横条loading-->
    <div id="imgloading" style="visibility:hidden;">
        <img src="images/loading5.gif" border="0">
    </div>
    <!--左图标-->
    <img src="images/icon_left.png" onclick="pre_picture();" alt="上一个" title="上一个">
    <!--左图标和右图标之间的内容-->
    <span id="lable1"
          style="padding:6px;line-height:30px;vertical-align:top;font-size:15pt;color:#FFF;font-weight:bold;">&nbsp;</span>
    <!--右图标-->
    <img src="images/icon_right.png" onclick="next_picture();" alt="下一个" title="下一个">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <!--放大-->
    <img src="images/icon_zoomin.png" onclick="zoom(20);" alt="放大" title="放大">
    <!--放大和缩小之间的内容-->
    <span id="lable2" onclick="image_resize();"
          style="padding:6px;line-height:30px;vertical-align:top;font-size:15pt;color:#FFF;font-weight:bold;cursor:pointer;"
          alt="实际大小" title="实际大小">100%</span>
    <!--缩小-->
    <img src="images/icon_zoomout.png" onclick="zoom(-20);" alt="缩小" title="缩小">
    <!--X图标-->
    <img src="images/icon_close.png" style="float:right;margin-right:20px;" onclick="close_picture();" alt="关闭"
         title="关闭">
    <br>
    <!-- xxx-->
    <div id="picturediv3" style="position:relative; margin:1px auto;">
        <img id="pic_prev" src="images/left_arrow.png"
             style="position:absolute; top:45%; left:10px; cursor:pointer; display:none;" onclick="pre_picture();">
        <img id="pic_next" src="images/right_arrow.png"
             style="position:absolute; top:45%; right:10px; cursor:pointer; display:none;" onclick="next_picture();">
        <!--<span id="picture_title" style='font-size:15pt;color:#FFF;font-weight:bold;'></span><br>-->
        <img id="picture" src="images/empty.gif" border="0" align="absmiddle" style="margin-top:10px;">
    </div>
    <br><br><br><br>
</div>

<!--灰色幕布-->
<div id="videodiv"
     style="position:absolute; z-index:104; top:0px;left:0px;z-index:101;width:100%;height:100%;background-color: #000;filter:alpha(opacity=80); opacity:0.80; display:none;"></div>
<!-- -->
<div id="videodiv2"
     style="position:absolute; z-index:105; width:100%; top:20px; left:0px; text-align:center; display:none;">
    <div id="videodiv3"></div>
    <br>

    <!--按钮：关闭和显示列表-->
    <button onclick='close_video();'><span><em>关闭</em></span></button>&nbsp;
    <button onclick='show_videolist();' id="videolist_btn"><span><em>显示列表</em></span></button>

    <div id="videolist_div"
         style="position:absolute; visibility:hidden; text-align:left; background-color:#FFF; border:1px solid #CCC; width:240px; height:120px; padding:2px; overflow-y:auto;">
    </div>
</div>


<!--左上部新页面（小） -->
<div id="uploadingDiv"
     style="position:absolute; width:340px; height:120px; left:100px; top:100px; padding:20px; line-height:20px; background:#FFF; z-index:90; display:none; border:1px solid #999;">
</div>


<!--背景灰色 -->
<div id="uploadingDiv_mask"
     style="position:absolute; z-index:1000; top:0px; left:0px; width:100%; height:3000px; background:#777; filter:alpha(opacity=60); opacity:0.60; display:none;"
     align="center">
</div>

<!--左上中界面-白色无边界-->
<div id="uploadingDiv2"
     style="position:absolute; width:500px; height:300px; padding:0px; margin:0px; line-height:20px; background:#FFF; z-index:1002; display:none;  "></div>

<!--右键菜单（文件）-->
<div id="menu_div" style="position:absolute; visibility:hidden; background-color:#FFF; width:200px;"
     onclick="return false;">
    <div class="menu_out">
        <div class="menu_in">
            <ul>
                <!--   -->
                <li style="margin-top:0px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="downloadFile_ext();">
                    <img src="images/open.gif">&nbsp;&nbsp;下载文件
                </li>
                <li id="weblinkitem" style="margin-top:4px;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="showDownloadUrl();"><img src="images/geturl.gif">&nbsp;&nbsp;Web外链
                </li>
                <li id="uplinkitem" style="margin-top:4px;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="showUploadUrl();"><img src="images/addlink.png">&nbsp;&nbsp;创建文件上传请求
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="editFile();"><img src="images/edit.gif">&nbsp;&nbsp;编辑
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="deleteFile(0);"><img src="images/delete.gif">&nbsp;&nbsp;删除
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="renameFile();"><img src="images/rename.gif">&nbsp;&nbsp;重命名
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="zipFile(0);"><img src="images/compress.gif">&nbsp;&nbsp;压缩文件
                </li>
                <li id="unzipitem" style="margin-top:4px;display:none;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="unzipFile();"><img src="images/uncompress.gif">&nbsp;&nbsp;解压缩文件
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="cutFile(0);"><img src="images/cut.gif">&nbsp;&nbsp;剪切
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="copyFile(0);"><img src="images/copy.gif">&nbsp;&nbsp;拷贝
                </li>
                <li id="pasteitem" style="margin-top:4px;display:none;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="pasteFile();"><img src="images/paste.gif">&nbsp;&nbsp;粘贴
                </li>
                <li style='margin-top:4px;' onmouseover='menuMouseOver(this)' onmouseout='menuMouseOut(this)'
                    onclick='show_office365()'><img src='plugins/office365/icon.png' width='16' height='16'>&nbsp;&nbsp;Office365
                </li>
                <li style='margin-top:4px;' onmouseover='menuMouseOver(this)' onmouseout='menuMouseOut(this)'
                    onclick='show_googledocs()'><img src='plugins/googledocs/icon.gif' width='16' height='16'>&nbsp;&nbsp;GoogleDocs
                </li>
            </ul>
        </div>
    </div>
</div>

<!--#####右键菜单（非文件）#####-->
<div id="menu_div2" style="position:absolute; visibility:hidden; background-color:#FFF; width:158px;"
     onclick="return false;">
    <div class="menu_out">
        <div class="menu_in">
            <ul>
                <li style="margin-top:0px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="checkUpload();"><img src="images/upload.gif">&nbsp;&nbsp;上传文件
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="createFolder();"><img src="images/newdir.gif">&nbsp;&nbsp;创建文件夹
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="newText();"><img src="images/newtxt.gif">&nbsp;&nbsp;创建文本文件
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="goTo();"><img src="images/goto.gif">&nbsp;&nbsp;跳转
                </li>
                <li id="pasteitem2" style="margin-top:4px;display:none;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="pasteFile();"><img src="images/paste.gif">&nbsp;&nbsp;粘贴
                </li>
                <li style='margin-top:4px;' onmouseover='menuMouseOver(this)' onmouseout='menuMouseOut(this)'
                    onclick='make_multiple_weblinks()'><img src='plugins/sendfiles/icon.gif' width='16' height='16'>&nbsp;&nbsp;批量发送WebLink
                </li>
            </ul>
        </div>
    </div>
</div>

<!--更多操作菜单-->
<div id="action_div"
     style="position:absolute; visibility:hidden; background-color:#FFF; width:200px; top:108px; left:378px;"
     onclick="return false;">
    <div class="menu_out">
        <div class="menu_in">
            <ul>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="cutFile(0);"><img src="images/cut.gif">&nbsp;&nbsp;剪切
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="copyFile(0);"><img src="images/copy.gif">&nbsp;&nbsp;拷贝
                </li>
                <li id="pasteitem3" style="margin-top:4px;display:none;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="pasteFile();"><img src="images/paste.gif">&nbsp;&nbsp;粘贴
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="goTo();"><img src="images/goto.gif">&nbsp;&nbsp;跳转
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="renameFile();"><img src="images/rename.gif">&nbsp;&nbsp;重命名
                </li>

                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="showDownloadUrl();"><img src="images/geturl.gif">&nbsp;&nbsp;Web外链
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="showUploadUrl();"><img src="images/addlink.png">&nbsp;&nbsp;创建文件上传请求
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="editFile();"><img src="images/edit.gif">&nbsp;&nbsp;编辑
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="newText();"><img src="images/newtxt.gif">&nbsp;&nbsp;创建文本文件
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="zipFile(0);"><img src="images/compress.gif">&nbsp;&nbsp;压缩文件
                </li>
                <li style="margin-top:4px;" onmouseover="menuMouseOver(this)" onmouseout="menuMouseOut(this)"
                    onclick="unzipFile();"><img src="images/uncompress.gif">&nbsp;&nbsp;解压缩文件
                </li>
                <li id="favorites_add" style="margin-top:4px;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="addBookmark();" title="添加当前路径到书签"><img
                        src="images/favorites.png">&nbsp;&nbsp;添加当前路径到书签
                </li>
                <li id="favorites_del" style="margin-top:4px;" onmouseover="menuMouseOver(this)"
                    onmouseout="menuMouseOut(this)" onclick="delBookmark();" title="从书签中删除当前路径"><img
                        src="images/favorites_del.png">&nbsp;&nbsp;从书签中删除当前路径
                </li>
                <li style='margin-top:4px;' onmouseover='menuMouseOver(this)' onmouseout='menuMouseOut(this)'
                    onclick='show_office365()'><img src='plugins/office365/icon.png' width='16' height='16'>&nbsp;&nbsp;Office365
                </li>
                <li style='margin-top:4px;' onmouseover='menuMouseOver(this)' onmouseout='menuMouseOut(this)'
                    onclick='show_googledocs()'><img src='plugins/googledocs/icon.gif' width='16' height='16'>&nbsp;&nbsp;GoogleDocs
                </li>
                <li style='margin-top:4px;' onmouseover='menuMouseOver(this)' onmouseout='menuMouseOut(this)'
                    onclick='make_multiple_weblinks()'><img src='plugins/sendfiles/icon.gif' width='16' height='16'>&nbsp;&nbsp;批量发送WebLink
                </li>
            </ul>
        </div>
    </div>
</div>


<div id="main_interface">
    <!--表1：最大框架-->
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0" align="center">
        <tr>
            <td height="100%" style="padding:5px;">
                <!--表2-->
                <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td height="100%" valign="top" bgcolor="#FFFFFF">
                            <!--表3-->
                            <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td height="66" background="images/top_bg.gif">
                                        <!--表4-->
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td width="13"><img src="images/coner_left.gif" width="13" height="66">
                                                </td>
                                                <td height="66" valign="bottom"
                                                    style="background:url(images/bg.jpg) no-repeat right bottom;">
                                                    <!--表5-->
                                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                        <tr>
                                                            <td width="303" id="main_logo_td"><img src="images/logo.jpg"
                                                                                                   width="200"
                                                                                                   height="50"></td>
                                                            <td align="right">
                                                                <!--表6-->
                                                                <table border="0" cellspacing="0" cellpadding="0">
                                                                    <tr>

                                                                        <td>[欢迎, <b>登陆</b>]</td>
                                                                        <td width="20">&nbsp;</td>
                                                                        <td id="diskquota">&nbsp;</td>
                                                                        <td width="20">&nbsp;</td>
                                                                        <!--<td><input type="image"-->
                                                                                   <!--src="images/ico_help.gif" class="cur"-->
                                                                                   <!--onclick="clientHelp();" alt="帮助"-->
                                                                                   <!--title="帮助" tabindex="-1"></td>-->
                                                                        <!--<td style="color:#FFF; cursor:pointer;"-->
                                                                            <!--onclick="clientHelp();">帮助-->
                                                                        <!--</td>-->

                                                                        <td width="15">&nbsp;</td>
                                                                        <td><input type="image"
                                                                                   src="images/ico_quit.gif" class="cur"
                                                                                   onclick="signOut();" alt="退出登录"
                                                                                   title="退出登录" tabindex="9"></td>
                                                                        <td style="color:#FFF; cursor:pointer;"
                                                                            onclick="signOut();">退出登录
                                                                        </td>
                                                                        <td width="10">&nbsp;</td>
                                                                    </tr>
                                                                <!--表6结束-->
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    <!--表5结束-->
                                                    </table>
                                                </td>
                                                <!--最上边白蓝条右边边框-->
                                                <td width="13"><img src="images/coner_right.gif" width="13" height="66">
                                                </td>
                                            </tr>
                                        <!--表4结束-->
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td height="100%">
                                        <!--表7-->
                                        <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <!--第二列左边白边-->
                                                <td width="13" style="background:url(images/left.gif) repeat-y;">
                                                    <div style="width:13px;"></div>
                                                </td>
                                                <!-- -->
                                                <td id="viewspace" bgcolor="#FFFFFF" valign="top"
                                                    style="height:500px; padding-top:3px;">

                                                    <!--上方留白-->
                                                    <div style="width:100%; padding-top:2px; overflow-x:hidden;">
                                                        <!--表8-->
                                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                                            <!--表8第一行-->
                                                            <tr valign="top">
                                                                <!--表8第一列-->
                                                                <td width="518">
                                                                    <!--向上图标-->
                                                                    <input type="image" src="images/icon_back.gif"
                                                                           alt="向上" title="向上" onclick="goUp()"
                                                                           class="cur" tabindex="1" id="first_button">&nbsp;
                                                                    <!--回到根目录-->
                                                                    <input type="image" src="images/icon_home.gif"
                                                                                 alt="回到根目录" title="回到根目录"
                                                                                 onclick="goHome()" class="cur"
                                                                                 tabindex="2"> &nbsp;
                                                                    <!--刷新-->
                                                                    <input type="image" src="images/icon_refresh.gif"
                                                                                                            alt="刷新"
                                                                                                            title="刷新"
                                                                                                            onclick="Refresh()"
                                                                                                            class="cur"
                                                                                                            tabindex="3">&nbsp;
                                                                    <!--上传文件-->
                                                                    <input type="image" src="images/icon_upload.gif" alt="上传文件"
                                                                                 title="上传文件" onclick="checkUpload()"
                                                                                 class="cur" tabindex="4"> &nbsp;
                                                                    <!--下载文件-->
                                                                    <input type="image" src="images/icon_download.gif"
                                                                        alt="下载文件" title="下载文件"
                                                                        onclick="downloadFile_ext()" class="cur"
                                                                        tabindex="5">&nbsp;
                                                                    <!--删除-->
                                                                    <input type="image"   src="images/icon_delete.gif"
                                                                                                   alt="删除" title="删除"
                                                                                                   onclick="deleteFile(0)"
                                                                                                   class="cur"
                                                                                                   tabindex="6">&nbsp;
                                                                    <!--创建文件夹-->
                                                                    <input type="image"  src="images/icon_newdir.gif"
                                                                                 alt="创建文件夹" title="创建文件夹"
                                                                                 onclick="createFolder()" class="cur"
                                                                                 tabindex="7"> &nbsp;
                                                                    <!--搜索-->
                                                                    <input type="image"  src="images/icon_search.gif"
                                                                                                            alt="搜索"
                                                                                                            title="搜索"
                                                                                                            onclick="openSearch()"
                                                                                                            class="cur"
                                                                                                            tabindex="-1">&nbsp;
                                                                    <!--以缩略图方式浏览-->
                                                                    <input type="image"  src="images/icon_thumb.gif"
                                                                                 alt="以缩略图方式浏览" title="以缩略图方式浏览"
                                                                                 onclick="change_viewmode(true)"
                                                                                 class="cur" id="thumbmode"
                                                                                 tabindex="-1"/>
                                                                    <!---->
                                                                    <input type="image"  src="images/icon_list.gif"
                                                                                                       alt="以列表方式浏览"
                                                                                                       title="以列表方式浏览"
                                                                                                       onclick="change_viewmode(false)"
                                                                                                       class="cur"
                                                                                                       style="display:none;"
                                                                                                       id="listmode"
                                                                                                       tabindex="-1"/>&nbsp;
                                                                    <!--更多操作-->
                                                                    <button
                                                                        class="mybutton" style="margin-top:6px;"
                                                                        onclick="clickMore();" alt="更多操作" title="更多操作"
                                                                        id="action_btn" tabIndex="-1"><span
                                                                        style="vertical-align:middle;"><em><img
                                                                        src="images/plusicon.gif" align="absmiddle">&nbsp;更多操作</em></span>
                                                                </button>
                                                                </td>
                                                                <td align="right" style="padding-top:6px; ">
                                                                    <b>执行多文件操作:</b>
                                                                    &nbsp;<button class="mybutton" onclick="zipFile(1);"
                                                                                  title="批量压缩" id="mzip_btn"
                                                                                  tabIndex="-1"><span
                                                                        style="vertical-align:middle;"><em><img
                                                                        src="images/compress.gif" align="absmiddle">&nbsp;批量压缩</em></span>
                                                                </button>&nbsp;<button class="mybutton"
                                                                                       onclick="deleteFile(1);"
                                                                                       title="批量删除" id="mdelete_btn"
                                                                                       tabIndex="-1"><span
                                                                        style="vertical-align:middle;"><em><img
                                                                        src="images/delete.gif" align="absmiddle">&nbsp;批量删除</em></span>
                                                                </button>&nbsp;<button class="mybutton"
                                                                                       onclick="cutFile(1);"
                                                                                       title="批量剪切" id="mcut_btn"
                                                                                       tabIndex="-1"><span
                                                                        style="vertical-align:middle;"><em><img
                                                                        src="images/cut.gif" align="absmiddle">&nbsp;批量剪切</em></span>
                                                                </button>&nbsp;<button class="mybutton"
                                                                                       onclick="copyFile(1);"
                                                                                       title="批量拷贝" id="mcopy_btn"
                                                                                       tabIndex="-1"><span
                                                                        style="vertical-align:middle;"><em><img
                                                                        src="images/copy.gif" align="absmiddle">&nbsp;批量拷贝</em></span>
                                                                </button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td height="25">
                                                                    &nbsp;<b>选择:</b> <span onclick="selectAll();"
                                                                                           class="cur">全部</span>, <span
                                                                        onclick="unselectAll();" class="cur">无</span>
                                                                </td>
                                                                <td align="right">
                                                                    <select id="bookmark" style="width:150px;"
                                                                            onchange="changeDirectory(this)">
                                                                        <option value="">=== 路径书签 ===</option>
                                                                    </select>
                                                                    &nbsp;&nbsp;<span id="statbar"></span>
                                                                </td>
                                                            </tr>
                                                        <!--表8结束-->
                                                        </table>
                                                        <!--表9-->
                                                        <!--列名表-->
                                                        <table id="listhead" width="100%" border="0" cellpadding="0"
                                                               cellspacing="0" style="table-layout:fixed;">
                                                            <tr>
                                                                <td width="500" onmouseover="className='listhead2';"
                                                                    onmouseout="className='listhead';" class="listhead"
                                                                    onmousedown="sortTable(this,'listtable', 0, 'filename');SetLastField(0);showthumb();">
                                                                    <div class="resizeblock"
                                                                         onmousedown="dragHead(this);">&nbsp;
                                                                    </div>
                                                                    名称
                                                                </td>
                                                                <td width="120" onmouseover="className='listhead2';"
                                                                    onmouseout="className='listhead';" class="listhead"
                                                                    onmousedown="sortTable(this,'listtable', 1, 'size');SetLastField(1);showthumb();">
                                                                    <div class="resizeblock"
                                                                         onmousedown="dragHead(this);">&nbsp;
                                                                    </div>
                                                                    大小
                                                                </td>
                                                                <td width="150" onmouseover="className='listhead2';"
                                                                    onmouseout="className='listhead';" class="listhead"
                                                                    onmousedown="sortTable(this,'listtable', 2);SetLastField(2);showthumb();">
                                                                    <div class="resizeblock"
                                                                         onmousedown="dragHead(this);">&nbsp;
                                                                    </div>
                                                                    类型
                                                                </td>
                                                                <td width="180" onmouseover="className='listhead2';"
                                                                    onmouseout="className='listhead';" class="listhead"
                                                                    onmousedown="sortTable(this,'listtable', 3);SetLastField(3);showthumb();">
                                                                    <div class="resizeblock"
                                                                         onmousedown="dragHead(this);">&nbsp;
                                                                    </div>
                                                                    修改时间
                                                                </td>
                                                                <td id="blanktd" class="listhead"></td>
                                                            </tr>
                                                        <!--表9结束-->
                                                        </table>
                                                    </div>

                                                    <!--实际文件列表-->
                                                    <div id="listview_div"
                                                         style="width:100%; height: 85%; overflow:auto; overflow-x:hidden;">
                                                        <!--表10-->
                                                        <table id="listtable" width="100%" border="0" cellpadding="0"
                                                               cellspacing="0" style="table-layout:fixed;">
                                                            <thead>
                                                            <tr height="0">
                                                                <td width="500"></td>
                                                                <td width="120"></td>
                                                                <td width="150"></td>
                                                                <td width="180"></td>
                                                                <td></td>
                                                            </tr>
                                                            </thead>
                                                            <tbody id="maintable"></tbody>
                                                        <!--表10结束-->
                                                        </table>
                                                    </div>


                                                    <div id="thumbview_div"
                                                         style="width:100%; height: 85%; overflow:auto; overflow-x:hidden; display:none;">
                                                        <!--表11-->
                                                        <table width="100%" border="0" cellpadding="0" cellspacing="0"
                                                               border="0">
                                                            <tbody id="thumbtable"></tbody>
                                                        <!--表11结束-->
                                                        </table>
                                                        <div>


                                                </td>
                                                <td width="13" style="background:url(images/right.gif) repeat-y;">
                                                    <div style="width:13px;"></div>
                                                </td>
                                            </tr>
                                        <!--表7结束-->
                                        </table>
                                    </td>
                                </tr>
                            <!--表3结束-->
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td height="12" background="images/bottom_bg.gif" bgcolor="#00CC33">
                            <!--表12-->
                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td width="13" valign="top"><img src="images/coner_left1.gif" width="13"
                                                                     height="12"></td>
                                    <td width="100%" valign="top"></td>
                                    <td width="13" valign="top"><img src="images/coner_right1.gif" width="13"
                                                                     height="12"></td>
                                </tr>
                            <!--表12结束-->
                            </table>
                        </td>
                    </tr>
                <!--表2结束-->
                </table>

            </td>
        </tr>
        <tr>
            <td align="center">
                <a href="https://www.wftpserver.com/" target="_blank">Wing FTP Server</a> ©2003-2020
                <b>wftpserver.com</b> All Rights Reserved
            </td>
        </tr>
    <!--表1结束-->
    </table>
</div>

<iframe name='hiddenframe' id='hiddenframe' src='empty.html' style='display:none'></iframe>
</body>
</html>


<!--<script>


    ajaxRequest("dir", "r=" + Math.random());
    _TIMER_KEEPLIVE = setInterval("keeplive()", 1000 * 300);

    getBookmark();

    document.oncontextmenu = function () {
        var evt = getEvent();
        var element = evt.srcElement || evt.target;
        if ((element.tagName == "INPUT" || element.tagName == "TEXTAREA")) {
            return true;
        } else {
            if ((top.__zIndex != null && top.__zIndex > 100) || $("picturediv").style.display == "" || $("videodiv").style.display == "" || $("uploadingDiv_mask").style.display == "") {
            } else {
                if ($("menu_div").style.visibility == "hidden" && $("menu_div2").style.visibility == "hidden") {
                    var evt = getEvent();
                    moreaction_show = false;
                    $("action_div").style.visibility = "hidden";
                    $("menu_div").style.visibility = "hidden";
                    $("menu_div2").style.visibility = "";
                    $("menu_div2").style.top = evt.clientY;
                    $("menu_div2").style.left = evt.clientX;
                }
            }
            return false;
        }
    }

    document.body.onclick = function () {
        var evt = getEvent();
        var element = evt.srcElement || evt.target;
        $("menu_div").style.visibility = "hidden";
        $("menu_div2").style.visibility = "hidden";

        if ($("action_div").style.visibility == "" || $("action_div").style.visibility == "visible") {
            if (element.id != "action_btn" && moreaction_show == true) {
                clickMore();
            }
        }

        if ($("videolist_div").style.visibility == "" || $("videolist_div").style.visibility == "visible") {
            if (element.id != "videolist_btn" && videolist_show == true) {
                close_videolist();
            }
        }

    }

    if (isOpera)
        document.onkeypress = myKeyDown;
    else
        document.onkeydown = myKeyDown;


    if (isFirefox) {
        $("viewspace").style.height = ((window.screen.height - 270) > 500 ? (window.screen.height - 270) : 500) + "px";
    }

    if (isEdge || isIE11) {
        try {
            $("listview_div").style.height = "74vh";
            $("thumbview_div").style.height = "74vh";
        } catch (e) {
        }
    }

    var files = null;
    var currentIndex = 0;
    var totalFiles = 0;

    function FileDragHover(e) {
        e.stopPropagation();
        e.preventDefault();
        e.target.className = (e.type == "dragover" ? "hover" : "");

        if (__zIndex != null && __zIndex == 100 && $("picturediv").style.display == "none") {
            var xmlhttpObj = isIE ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();
            var url = "checkupload.html?r=" + Math.random();
            xmlhttpObj.open("GET", url, false);
            xmlhttpObj.send("");

            var result = xmlhttpObj.responseText;
            if (result == "") {
                var frametag = new Date().getTime();
                showMessagebox("上传文件", "<iframe src='uploader_h5.html?r=" + Math.random() + "' width=700 height=390 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", closeUploader, 700, 390);
            }
        }

    }

    function FileSelectHandler(e) {

        e.stopPropagation();
        e.preventDefault();

        if (uploading == true || $("uploadingDiv2").style.display != "none") {
            return false;
        }

        FileDragHover(e);

    }

    function cancelUploadFile() {
        var result = cancelUpload();
        if (result == true) {
            $("uploadingDiv2").innerHTML = "";
            $("uploadingDiv2").style.display = "none";
            $("uploadingDiv_mask").style.display = "none";
            ajaxRequest("dir", "");
        }
    }


    function UploadFile(file) {

        var xhr = new XMLHttpRequest();

        var progress = $("progressDiv").appendChild(document.createElement("p"));
        progress.innerHTML = "&nbsp;&nbsp;0% " + file.name;

        if ($("progressDiv").offsetHeight < $("progressDiv").scrollHeight) {
            $("progressDiv").scrollTop = $("progressDiv").scrollHeight - $("progressDiv").offsetHeight;
        }

        xhr.upload.addEventListener("progress", function (e) {
            var pc = parseInt(100 - (e.loaded / e.total * 100));
            progress.style.backgroundPosition = pc + "% 0";
            if (progress.className != "failure") {
                progress.innerHTML = "&nbsp;&nbsp;" + (100 - pc) + "% " + file.name;
            }
        }, false);

        xhr.onreadystatechange = function (e) {
            if (xhr.readyState == 4) {
                var result = xhr.responseText;
                if (result == "-2" || xhr.status != 200) {
                    progress.className = "failure";
                    progress.innerHTML = "&nbsp;&nbsp; " + file.name + "<br>上传文件时发生了异常错误, 可能是没有上传权限(或者该文件被限制)造成的.";
                } else if (result == "-3") {
                    progress.className = "failure";
                    progress.innerHTML = "&nbsp;&nbsp; " + file.name + "<br>上传错误: 超过最大配额";
                } else if (result == "-4") {
                    progress.className = "failure";
                    progress.innerHTML = "&nbsp;&nbsp; " + file.name + "<br>上传错误: 超过最大上传限制";
                } else if (result == "0") {
                    alert("会话已经过期,请重新登录!");
                    //window.location = "logout.html";
                    gotoUrl("logout.html");
                } else {
                    progress.className = "success";
                    progress.innerHTML = "&nbsp;&nbsp;100% " + file.name;
                }

                currentIndex++;
                if (currentIndex < files.length) {
                    UploadFile(files[currentIndex]);
                } else {
                    uploading = false;
                    $("progressDiv").innerHTML += "<div style='text-align:center; padding:10px;'><button id='btn_closewindow' onclick='cancelUploadFile();'><span><em>&nbsp;&nbsp;关闭窗口&nbsp;&nbsp;</em></span></button></div>";

                    if ($("progressDiv").offsetHeight < $("progressDiv").scrollHeight) {
                        $("progressDiv").scrollTop = $("progressDiv").scrollHeight - $("progressDiv").offsetHeight;
                    }
                }
            }
        };


        if (checkOverwrite(file.name, totalFiles) == "0") {
            currentIndex++;
            if (currentIndex < files.length) {
                UploadFile(files[currentIndex]);
            } else {
                uploading = false;
                $("progressDiv").innerHTML += "<div style='text-align:center; padding:10px;'><button id='btn_closewindow' onclick='cancelUploadFile();'><span><em>&nbsp;&nbsp;关闭窗口&nbsp;&nbsp;</em></span></button></div>";

                if ($("progressDiv").offsetHeight < $("progressDiv").scrollHeight) {
                    $("progressDiv").scrollTop = $("progressDiv").scrollHeight - $("progressDiv").offsetHeight;
                }
            }

            return false;
        }


        xhr.open("POST", "uploadok.html", true);
        var fd = new FormData();
        fd.append("name", file.name);
        fd.append("file", file);
        xhr.send(fd);

    }


    // initialize
    function Init() {

        var filedrag = document.body;

        var xhr = new XMLHttpRequest();
        if (xhr.upload) {

            filedrag.addEventListener("dragover", FileDragHover, false);
            filedrag.addEventListener("dragleave", FileDragHover, false);
            filedrag.addEventListener("drop", FileSelectHandler, false);
            filedrag.style.display = "block";
        }

    }

    // call initialization file
    if (window.File && window.FileList && window.FileReader) {
        Init();
    }


    function show_office365() {
        if (selectedRow == null) {
            alert("请选择一个文件");
            return;
        }

        if (selectedRow.cells[2].innerHTML != "文件夹") {
            var f_name = selectedRow.cells[0].getAttribute("name");
            var filename = htmldecode(f_name);
            filename = urlEncodeSpecial(f_name);
            var localaddress = location.href.replace(/\#/g, "");
            var downloadURL = localaddress + "?download&filename=" + filename + "&UID=fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229&nowpath=" + urlEncodeSpecial(now_dir) + "&r=" + Math.random();
            var frametag = new Date().getTime();
            showMessagebox("<span title='" + f_name + "'>" + f_name.substr(0, 55) + (f_name.length > 55 ? "..." : "") + "</span>", "<iframe src='https://view.officeapps.live.com/op/view.aspx?src=" + encodeURIComponent(downloadURL) + "' width=920 height=580 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 920, 580);
        } else {
            alert("请选择一个文件");
        }
    }

    function show_googledocs() {
        if (selectedRow == null) {
            alert("请选择一个文件");
            return;
        }

        if (selectedRow.cells[2].innerHTML != "文件夹") {
            var f_name = selectedRow.cells[0].getAttribute("name");
            var filename = htmldecode(f_name);
            filename = urlEncodeSpecial(f_name);
            var localaddress = location.href.replace(/\#/g, "");
            var downloadURL = localaddress + "?download&filename=" + filename + "&UID=fa5c61da6b84b10dff7d99955f7b2721fe01ce2a7fbac8fafaed7c982a04e229&nowpath=" + urlEncodeSpecial(now_dir) + "&r=" + Math.random();
            var frametag = new Date().getTime();
            showMessagebox("<span title='" + f_name + "'>" + f_name.substr(0, 55) + (f_name.length > 55 ? "..." : "") + "</span>", "<iframe src='https://docs.google.com/viewer?embedded=true&url=" + encodeURIComponent(downloadURL) + "' width=920 height=580 border=0 frameborder=0 id='modify" + frametag + "'></iframe>", null, 920, 580);
        } else {
            alert("请选择一个文件");
        }
    }

    function make_multiple_weblinks() {
        alert('请先在域的常规设置中选择一个SMTP配置选项.');
        return false;
        var filelist = getCheckedDirlist(0);
        var dirlist = getCheckedDirlist(1);
        if (filelist == "" && dirlist == "") {
            alert("执行多文件操作时, 至少要勾选一个勾选框(checkbox).");
            return false;
        } else {
            var temp_filelist = filelist.replace(/\|\|/ig, "\n");
            var temp_dirlist = dirlist.replace(/\|\|/ig, "\n");

            showMessagebox("Send Files", "<table width='100%' border='0' cellpadding='2' cellspacing='3'><tr><td style='padding-left:10px;padding-top:15px;' colspan=2><b>批量生成下列文件的WebLink并通过email发送:</b></td></tr><tr><td style='padding-left:10px;padding-top:5px;' colspan=2><textarea id='input_files' style='width:460px;height:85px' readonly> </textarea></td></tr><tr><td style='padding-left:10px;width:130px;'>过期时间:</td><td><input id='expiretime' type='text' value='' onclick='selectTime();' style='width:150px;' readonly tabindex='34'> <span><em><img src='images/clean.gif' align='absmiddle' id='btn_clear_date' onclick='clearTime();' title='Clean' style='border: 1px solid #666; padding:0px; cursor:pointer;' tabindex='35'>&nbsp;</em></span> (可选)</td></tr><tr><td style='padding-left:10px; width:110px;'>最大下载次数:</td><td><input id='downloadlimit' type='text' maxlength='6' value='' onkeyup='formatLimitNumber(this.value);' onafterpaste='formatLimitNumber(this.value);' style='width:150px;' tabindex='36'> (可选)</td></tr><tr><td style='padding-left:10px; width:110px;'>密 码:</td><td><input id='downloadpass' type='text' maxlength='30' value='' style='width:150px;' tabindex='37'> <button onclick='generateRandom();' title='生成一个随机的密码'><span style='vertical-align:middle;'><em><img src='images/password.gif' align='absmiddle'>&nbsp;</em></span></button> (可选)</td></tr><tr><td style='padding-left:10px; width:110px;'>发送邮件到:</td><td><input id='mail_address' type='text' maxlength='100' tabindex='39' onblur=\"if(this.value=='') this.value='使用逗号分隔电子邮件地址'\" onfocus=\"if(this.value =='使用逗号分隔电子邮件地址' ) this.value=''\" value='使用逗号分隔电子邮件地址' style='width:320px;color:#898989;'></td></tr><tr><td style='padding-left:10px; width:110px; padding-top:10px;'>我的邮件地址:</td><td><input id='sender_mail_address' type='text' maxlength='80'  tabindex='38' style='width:180px; color:#898989;'> (可选)</td></tr><tr><td style='padding-left:10px;'>发送消息 (可选):</td><td><textarea id='mail_message' style='width:320px;height:35px' maxlength='300' tabindex='40'></textarea> </td></tr><tr align='center'><td height='50' colspan=2><button id='btn_submit' type='submit' onclick='send_weblinks();' tabindex='40'><span><em> 确 定 </em></span></button>&nbsp;&nbsp;&nbsp;<button id='btn_cancel' onclick='top.closewindow();' tabindex='41'><span><em> 取 消 </em></span></button></td></tr></table>", null, 530, 400);


            $("input_files").value = temp_filelist + "\n" + temp_dirlist;

            if (isIE) {
                $("btn_submit").onclick = function () {
                    send_weblinks();
                };
                $("btn_cancel").onclick = function () {
                    top.closewindow();
                };
            }
        }

    }

    function send_weblinks() {
        var xmlhttpObj = isIE ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();
        var expiretime = htmldecode($("expiretime").value);
        var downloadlimit = htmldecode($("downloadlimit").value);
        var downloadpass = htmldecode($("downloadpass").value);
        var mailaddress = htmldecode($("mail_address").value);
        var sender_mailaddress = htmldecode($("sender_mail_address").value);
        var mail_message = htmldecode($("mail_message").value);
        var weblink_url = "";
        var localaddress = weblink_url;
        if (localaddress == "")
            localaddress = location.href.replace(/\#/g, "");

        if (mailaddress == "" || mailaddress == "使用逗号分隔电子邮件地址") {
            alert("Please specify one or more recipients!");
            return false;
        }

        $("waitingdiv").style.display = "";
        xmlhttpObj.open("POST", "plugins/sendfiles/generate_weblinks.html");
        xmlhttpObj.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xmlhttpObj.onreadystatechange = function () {
            if (xmlhttpObj.readyState == 4) {
                ajaxlock = false;
                if (xmlhttpObj.status == 200) {
                    try {
                        if (xmlhttpObj.responseText != "") {
                            alert(xmlhttpObj.responseText);
                        }

                        unselectAll();
                        top.closewindow();

                    } catch (e) {
                    } finally {
                        $("waitingdiv").style.display = "none";
                    }
                } else {
                    $("waitingdiv").style.display = "none";

                }
            }
        };
        xmlhttpObj.send("filelist=" + urlEncode(getCheckedDirlist(0)) + "&dirlist=" + urlEncode(getCheckedDirlist(1)) + "&mailaddress=" + urlEncode(mailaddress) + "&sender_mailaddress=" + urlEncode(sender_mailaddress) + "&mail_message=" + urlEncode(mail_message) + "&localaddress=" + urlEncode(localaddress) + "&expiretime=" + urlEncode(expiretime) + "&downloadlimit=" + urlEncode(downloadlimit) + "&downloadpass=" + urlEncode(downloadpass) + "&r=" + Math.random());
    }


</script>

-->








